[
  {
    "title": "Kubernetes 1.24发布，支持网络策略状态、上下文日志记录和子资源",
    "url": "https://www.infoq.cn/article/pyA10OKOv9ja0lIdjRCk",
    "summary": "<p>云原生计算基金会（CNCF）于5月发布了代号为Stargazer的<a href=\"https://kubernetes.io/blog/2022/05/03/kubernetes-1-24-release-announcement/\">Kubernetes 1.24</a>\"。该版本的新特性有网络策略状态、上下文日志记录和签名发布工件等，正式或稳定特性有PodOverhead、CSI卷扩展和CSR持续时间，Beta特性有OpenAPI v3、gRPC探针、卷填充器等，弃用特性有DynamicKubeletConfig等。此外，1.24版本移除了<a href=\"https://www.infoq.com/news/2022/01/kubernetes-dockershim-removal/\">dockershim</a>\"。</p><p>&nbsp;</p><p>在这个新版本中，kubectl（运行集群命令的命令行工具）包含了一个新的subresource标识，可用于获取和更新子资源。使用这个新的子命令更新子资源比使用curl命令简单。</p><p>&nbsp;</p><p>引入<a href=\"https://kubernetes.io/blog/2022/05/25/contextual-logging/\">上下文日志记录</a>\"是为了使日志输出更加有用。该特性使库的调用者可以向其传递日志记录器实例，并使用该实例进行日志记录，而不是全局日志记录器。</p><p>&nbsp;</p><p>为了提高供应链安全性，现在可以使用<a href=\"https://docs.sigstore.dev/cosign/installation/\">cosign</a>\"（signstore的一种用于签名、验证并保护软件的工具）对发布工件相关的容器镜像进行签名和验证。</p><p>&nbsp;</p><p>在1.24版本中，<a href=\"https://kubernetes.io/docs/concepts/services-networking/network-policies/\">网络策略</a>\"中添加了一个<a href=\"https://github.com/kubernetes/enhancements/tree/master/keps/sig-network/2943-networkpolicy-status\">状态</a>\"子资源，用户可以更轻松地排除与网络相关的问题，因为不同的<a href=\"https://github.com/containernetworking/cni\">CNI</a>\"实现了不同的网络策略。</p><p>&nbsp;</p><p>在1.24版本中，<a href=\"https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.0.md\">OpenAPI v3</a>\"支持进入Beta阶段，并且默认开启。该特性允许kube-apiserver（该服务器验证和配置API对象的数据，包括pod、服务等）提供OpenAPI v3格式的对象。</p><p>&nbsp;</p><p>此外，在Beta版本中，对于LoadBalancer类型的服务，<a href=\"https://kubernetes.io/docs/concepts/services-networking/service/#load-balancers-with-mixed-protocol-types\">混合协议</a>\"默认启用，LoadBalancer类型的服务可以在同一端口上提供不同的协议，如TCP和UDP。</p><p>&nbsp;</p><p><a href=\"https://kubernetes.io/docs/concepts/architecture/nodes/#graceful-node-shutdown\">节点优雅关闭</a>\"最初在1.21版本中引入，现在处于Beta测试阶段。该特性可以区分是要终止节点上运行的常规pod还是关键pod，并为停止pod提供额外的时间。</p><p>&nbsp;</p><p>CSI<a href=\"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#csi-volume-expansion\">卷扩展</a>\"在此版本中成为正式特性，并默认启用。只要底层CSI<a href=\"https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/#list-of-csi-drivers\">驱动程序</a>\"支持卷扩展，该特性就可以动态调整持久卷的大小。</p><p>&nbsp;</p><p>此外，<a href=\"https://kubernetes.io/docs/concepts/scheduling-eviction/pod-overhead/\">PodOverhead</a>\"在此版本中变得稳定，并默认启用。该特性使Kubernetes在调度容器时可以把容器请求和限制之外的容器基础设施考虑进来。要利用这一特性，需要一个定义开销字段的<a href=\"https://kubernetes.io/docs/concepts/containers/runtime-class/\">Runtime</a>\"类。</p><p>&nbsp;</p><p>在1.24版本中，<a href=\"https://kubernetes.io/docs/concepts/storage/storage-capacity/\">存储容量</a>\"跟踪也成为稳定特性。该特性使Kubernetes调度器可以在放置pod之前知道节点的关联存储是否有足够的容量。如此一来，它就可以过滤掉没有足够存储空间的节点，减少调度尝试次数。</p><p>&nbsp;</p><p><a href=\"https://kubernetes.io/\">Kubernetes</a>\"是一个用于部署、扩展和管理应用程序容器的生产级开源编排系统。</p><p>&nbsp;</p><p>根据<a href=\"https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.24.md\">发布说明</a>\"，Kubernetes 1.24版本带来了46项增强，其中13项是新增，13项是正式可用或变得稳定，15项是Beta版本。此外，有6项特性被弃用。</p><p>&nbsp;</p><p>CNCF于2022年5月24日举办了一场<a href=\"https://www.youtube.com/watch?v=TNo22-a27oY\">网络研讨会</a>\"，回顾了主要特性并进行了答疑。</p><p>&nbsp;</p><p>&nbsp;</p><p>原文链接：</p><p><a href=\"https://www.infoq.com/news/2022/11/kubernetes-1-24/\">https://www.infoq.com/news/2022/11/kubernetes-1-24/</a>\"</p><p></p><p>相关阅读：</p><p><a href=\"https://www.infoq.cn/minibook/IDAGRlr1RAeLg8l6sZTy\">Kubernetes&nbsp;安全防护终极指南</a>\"</p><p><a href=\"https://www.infoq.cn/article/zFR1q0chGl6SwFd1QMiD\">Kubernetes 的未来：OIDC 要优于 Secret，Ingress 并不合适</a>\"</p><p></p><p></p>",
    "publish_time": "2022-11-14 08:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  }
]