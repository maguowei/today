[
  {
    "title": "无距离编程，使用JetBrains Rider进行远程开发",
    "url": "https://www.infoq.cn/article/adcCDFjOWA1stLKY7pJZ",
    "summary": "<p><a href=\"https://blog.jetbrains.com/dotnet/2023/03/22/remote-development-with-jetbrains-rider/\">JetBrains提供了Remote Development Beta</a>\"。该工具会在本地运行一个<a href=\"https://en.wikipedia.org/wiki/Thin_client\">瘦客户端</a>\"，并连接到IDE后端，提供了全功能的用户界面。这个过程可以由<a href=\"https://www.jetbrains.com/rider/?_ga=2.238971264.1604876641.1681400636-447018392.1681400636\">JetBrains Rider</a>\"或<a href=\"https://www.jetbrains.com/remote-development/gateway/?_ga=2.193872045.1604876641.1681400636-447018392.1681400636\">JetBrains Gateway</a>\"来处理。它还需要一台启用了SSH的服务器。该工具的工作流很流畅，编辑在本地完成，JetBrains客户端会与后端同步更改内容。</p><p>&nbsp;</p><p>JetBrains Rider 2022.2可以访问<a href=\"https://www.jetbrains.com/remote-development/?_ga=2.180951714.401190422.1681398683-94266463.1681398682\">Remote Development</a>\"的Beta测试版。其他基于IntelliJ平台构建的JetBrains IDE之前已经引入了这个特性。JetBrains Remote Development可以在任何支持SSH的远程服务器上托管源代码、工具链和IDE后端。基于IntelliJ平台的瘦客户端让用户可以利用和本地相同的Rider开发工作流。</p><p>&nbsp;</p><p>Remote Development通过SSH连接到现有的服务器。IDE作为后端服务安装，它在加载项目时不显示用户界面。瘦客户端在本地运行并连接到该IDE后端，然后提供功能齐全的用户界面。这让人觉得IDE是在本地运行，虽然所有处理都是在远程服务器上完成的。</p><p>&nbsp;</p><p>要使用Remote Developmen，必须安装最新版本的JetBrains Rider——2022.3或更高版本。也可以使用JetBrains Gateway，它提供了相同的功能，但只需安装瘦客户端。如果只计划进行远程开发，则JetBrains Gateway是一个解决方案。</p><p>&nbsp;</p><p>另一个必要条件是远程服务器启用了SSH。JetBrains建议，远程服务器的最低配置为2核、4GB RAM和5GB磁盘，但这完全取决于解决方案和开发工作流。目前，远程服务器必须是Linux的，但Mac和Windows支持也在计划之中。</p><p>&nbsp;</p><p>在JetBrains Rider启动窗口中，右侧有一个Remote Development区域。它提供了两个选项：SSH和JetBrains Space。JetBrains承诺，未来会有更多来自谷歌、Amazon、GitHub、GitPod和Windows Subsystem for Linux（WSL）等合作伙伴的提供程序。在旁边的Connect to SSH窗口中，可以选择现有的连接，或者通过指定需要添加到远程服务器的用户名、主机、端口和本地私钥来新建SSH连接，以便对基于SSH的服务（如Git）进行身份验证。</p><p>&nbsp;</p><p>Remote Development的使用体验很流畅，编辑在本地进行，JetBrains客户端与后端同步更改内容。所有处理都在后端机器上进行。这包括对解决方案文件进行索引或磁盘访问。此外，开发人员还可以利用Rider实例上部的Backend Status Details小部件观察远程指标。这个小部件会显示服务器的CPU、内存和磁盘资源使用情况。</p><p></p><p>原文链接：</p><p><a href=\"https://www.infoq.com/news/2023/04/remote-development-with-rider/\">https://www.infoq.com/news/2023/04/remote-development-with-rider/</a>\"</p><p></p><p>相关阅读：</p><p><a href=\"https://www.infoq.cn/article/4zm3T5aeOKzej15X9YKR\">另一种“推翻” VS Code 的尝试：JetBrains Fleet 现开放公测</a>\"</p><p><a href=\"https://www.infoq.cn/article/mZbskCPmQDJWg1HrDjbL\">JetBrains IntelliJ IDEA 2022.2使用Java 17运行时</a>\"</p>",
    "publish_time": "2023-06-14 08:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "工业“智”造转型，如何兼顾技术与经济效益 | 直播报名预约",
    "url": "https://www.infoq.cn/article/vZhrJagdJVhJM1YVydQe",
    "summary": "<p>工业进化的本质是什么？从机械化、电气化、自动化再到智能化，工业制造持续演进背后的驱动力，是对效率、质量和成本的极致追求。而眼下，随着工业产品研发和生产周期缩短，劳动力和原材料成本上升，加上绿色化逐步成为一个硬指标，全球<a href=\"https://www.infoq.cn/article/XlyVG0TzW8kZQA0xFiJl\">工业制造</a>\"又进入一个全新发展阶段。</p><p></p><p>无疑，那些能够更快把数字技术与先进制造进行融合的企业，将率先化解当下困境，重塑自身竞争力。但是，制造业作为一个低利润行业，在转型升级的过程中，既要把握技术效益也要兼顾经济效益。如何更好地平衡投入产出，同样是一个不可忽视的课题。</p><p></p><p>那么，<a href=\"https://www.infoq.cn/article/XB8TyD9bvDZTudesmEQU\">人工智能</a>\"、物联网、数字孪生等现如今关注度颇高的技术具体如何与制造场景结合，帮助企业实现提质增效、成本优化和节能减排？制造企业应该在什么时间、引入哪些合适的技术、落地到哪些合适的场景？实现产品高质量同时是否就意味着高成本投入？本期《<a href=\"https://www.infoq.cn/theme/192\">超级连麦.数智大脑</a>\"》由InfoQ与TGO鲲鹏会联合出品，将邀请来自工业制造领域头部企业分享他们的亲身实践。</p><p></p><p>点击下方<a href=\"https://live.infoq.cn/room/1803\">链接</a>\"即可率先报名预约（留下你关心的问题，讲师将在直播中解答）：<a href=\"https://live.infoq.cn/room/1803\">https://live.infoq.cn/room/1803</a>\"</p><p></p><h2>直播时间</h2><p></p><p>7&nbsp;月&nbsp;5&nbsp;日（周三）&nbsp;19:30-22:00</p><p></p><h2>联合出品</h2><p></p><p>InfoQ&nbsp;x&nbsp;<a href=\"https://tgo.infoq.cn/\">TGO鲲鹏会</a>\"&nbsp;x&nbsp;<a href=\"https://b.geekbang.org/?utm_source=geektimeWeb&amp;utm_medium=menu&amp;utm_campaign=entranceplatform&amp;gk_source=2021090101_geektimeweb_menu\">极客时间企业版</a>\"</p><p></p><h2>直播主题</h2><p></p><p>工业“智”造转型，如何兼顾技术效益与经济效益</p><p></p><h2>直播议程（拟）</h2><p></p><p></p><h4>19:30-20:00&nbsp;&nbsp;议题分享-当AI遇上制造：工业智能化实践分享</h4><p></p><p>话题概述：AI的热度在近半年来持续飙升。但AI与制造的结合，事实上已经由来已久。比如，通过智能化排产提高产线效率，借助智能视觉检测减少次品率，通过对设备能耗的实时智能化分析实现节能减排.....只不过，由于工业制造的行业知识门槛较高，加上数据量级和数据质量的局限性等等，AI在工业场景的落地开花还存在巨大挑战。本议题将邀请在工业智能化方面拥有成功经验的企业分享亲身实践。</p><p></p><h4>20:00-20:30&nbsp;议题分享-碳管理与产能并重，绿色工厂是如何建成的</h4><p></p><p>话题概述：绿色制造并不算是一个新课题，只不过在“双碳”战略目标下，这个课题更为重要且紧迫。但是，节能减排与产能提升两个目标的兼顾是一个普遍难题，要实现二者平衡，需要让碳管理贯穿于制造全过程，让能源管理与各个业务模块间的协调运作。在这个过程中，借助数字技术，企业可以实现设备的连接、实时的监测和分析从而更有针对性地做到节能减排。本议题将邀请具有代表性的工业企业，分享绿色工厂是如何建成的。</p><p></p><h4>20:30-21:00&nbsp;议题分享-给工厂造个数字分身：数字孪生在工业制造的落地应用</h4><p></p><p>话题概述：工业制造是数字孪生的主战场，通过把相关技术应用于产品设计、生产制造和远程售后服务等方面，可以帮助企业更好地反馈和优化业务结果，减少成本浪费。但是，数字孪生相关技术本身的资金投入并不小，场景的选择非常重要。本议题将邀请数字孪生领域的头部企业，揭秘数字孪生技术的价值，分享在工业制造成功落地的先决条件，以及制造企业如何选择合适的应用场景。</p><p></p><h4>21:00-21:40&nbsp;连麦对话-工业“智”造转型，如何评估投入产出比</h4><p></p><p>话题概述：在追求效率和质量的同时，制造业面临的成本压力比其它行业还要大得多。因为传统制造是一个低利润行业，非常讲求资金利用率，对于数字化这样一个投入不小但见效周期又比较长的领域，很难做到“挥金如土”。那么，制造企业具体如何在转型制造过程中让技术的价值最大化，又如何平衡好效率、质量和成本的关系呢？本议题将与各位专家连麦，探讨工业“智”造转型过程中的经济效益问题。</p><p></p><p>&gt;&gt;&gt;直播报名通道：<a href=\"https://live.infoq.cn/room/1803\">https://live.infoq.cn/room/1803</a>\"</p><p>&gt;&gt;&gt;此次直播特别开放讲师自荐通道：如果你希望作为讲师参与此次直播分享，欢迎加好友沟通（注明来意）</p><p></p><p><img src=\"https://static001.infoq.cn/resource/image/b0/5c/b00851ecf5b7e9d050e7a2bb3e5a4d5c.jpg\" /></p><p></p>",
    "publish_time": "2023-06-14 09:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "从硬件走向“软件+AI”，联想首次亮相七大行业解决方案",
    "url": "https://www.infoq.cn/article/UBJqidXffttR5lUYbeXw",
    "summary": "<p>6月13日，2023联想创新开放日上，联想全面展示了七大行业核心解决方案。这也是联想在新财年宣布成立七大纵队以来，全行业方案服务能力首次亮相。在此基础上，联想还首次集中展示了AI底层技术驱动的多个行业解决方案，进一步强化了联想通过AI推动智能化转型中的技术和方案领先性。</p><p></p><p>据了解，联想经过六年的努力和坚持，在两大转型持续深化下，开启了新一轮组织变革。联想中国为打造面向不同客群、统一的3S营销和销售平台，深化以客户为中心转型，宣布成立了七大行业纵队——政府纵队、运营商纵队、金融纵队、教育纵队、互联网服务纵队、制造纵队和重点行业纵队。未来联想中国将整合资源，快速提升在这几大行业的3S份额。</p><p></p><h2>七大纵队核心解决方案首发亮相</h2><p></p><p></p><p>七大行业纵队的成立，是联想中国推进以客户为中心转型进入智能化时代的标志性事件。联想通过持续深化以客户为中心的转型和3S转型两大转型建立了业内领先的客户直达业务模式，PC业务连续五年创下市场份额的历史新高；PC之外的3S业务保持了高速成长，联想集团2022/23财年业绩报告显示，全年非PC营收占比提升到近40%。</p><p> </p><p>此次创新开放日上联想首次展示七大行业核心解决方案和服务能力，标志着联想已经开始从硬件提供商逐渐蜕变成3S全栈的产品、解决方案以及服务提供商，并依托端-边-云-网-智的新IT架构，以及多年来沉淀出的智能引擎擎天，为客户提供智能化全旅程的陪伴式服务。在完成了3S业务布局后，联想中国区将集合七大纵队的核心能力，全面冲击3S市场份额第一。</p><p> </p><p>七大行业纵队全栈出击，堪称联想进入智能化时代的里程碑事件，也是本次开放日活动中，在行业智能化转型场景解决方案的展示中倍受关注的焦点之一。</p><p></p><p>今年2月，中共中央、国务院印发《数字中国建设整体布局规划》，提出建设数字中国是数字时代推进中国式现代化的重要引擎，目标是到2025年，基本形成横向打通、纵向贯通、协调有力的一体化推进格局，数字中国建设取得重要进展。联想正是前瞻性地看到了智能化变革的趋势而提前布局，通过6年来自身智能化转型实践和业务变革，形成了与行业其它竞争对手差异化的竞争力和为行业赋能的能力。</p><p></p><p>聚焦到政府领域，《数字中国建设整体布局规划》已经发布。建设公平规范的数字治理生态，构建开放共赢的数字领域国际合作格局，成为亟待以智能技术变革和重塑的两大领域；推进数字技术与五位一体深度融合，支持数字经济做优做大、数字政务高效协同、数字文化自信繁荣、数字社会普惠便捷、数字生态文明绿色普惠成为重要发力点。全新的需求对算力基础设施、网络基础设施、数据平台及服务和安全产品的供给提出了更高的要求。</p><p></p><h2>多行业多场景落地“硬件+软件+服务”产品组合</h2><p></p><p></p><p>以智慧医疗为关键场景之一，依托联想新IT技术架构，硬件+软件+服务产品组合，技术研发与方案定制能力及服务保障体系，支撑医疗等政府行业数字化转型，联想重磅推出了多院区/区域医疗中心基础设施解决方案、医疗云桌面解决方案等12大智慧医疗解决方案，针对行业痛点，以个性化的方案服务助力山东大学齐鲁医院、河南儿童医院等客户的智能化转型。</p><p>在制造业领域，由于政策和技术趋势的推动，其正向高端化、智能化和绿色化迈进。联想以3S全栈的产品、方案和服务以及卓越的供应链能力，赋能制造业客户实现降本增效、安全可控、零碳制造等智能化转型需求。打造了18个智能制造解决方案助力智能化转型，包括数据迁移解决方案、智慧能源管理方案、机器人远程审厂方案、智慧焊接方案、SAP HANA解决方案等。</p><p> </p><p>在教育领域，联想基于对高教、高职和中职以及普教等教育客户的需求洞察，依托先进的算力能力，打造了联想HPC解决方案、模块化数据中心解决方案、教育数据存储解决等9大智慧教育解决方案，可以提供全学段、全场景教学信息化产品、解决方案和服务，并打造了北京大学温水水冷高性能计算方案，华中师范大学高性能计算平台等一系列标杆案例。</p><p> </p><p>运营商纵队则凭借联想自身领先的新IT架构和转型经验，并立足云网融合、算网一体建设主力军的身份，携手运营商伙伴，赋能运营商云转数改，建立产业数字化新航道，全面协同运营商伙伴核心新基建建设，为政企客户打造了包括SAP从硬件平台到应用开发与服务的端到端能力、超大规模企业级云管理与运维等在内的五大运营商行业解决方案，成功赋能联宝科技5G专网助力新智造，以及重庆保税港物流智能化等智能化转型案例。</p><p><img src=\"https://static001.infoq.cn/resource/image/7d/72/7d5542baba20eb9a3985c46ee8080772.jpg\" /></p><p>而在金融领域，联想凭借长期服务金融客户的成功经验以及行业know-how、服务保障体系，为金融客户在智能化转型中提供从桌面到数据中心的硬件基础设施、端到端13+智慧金融解决方案及全生命周期服务。</p><p></p><p>在互联网服务领域，联想聚焦人工智能、增强现实、区块链、云计算/边缘计算、设备创新、5G六大前沿科技领域，通过稳定可靠的全栈产品+服务的经验、卓越灵活的产品定制化能力，助力互联网企业持续降低TCO，满足互联网企业提升数据中心能力和云端竞争力的需求。</p><p> </p><p>除此之外，联想还针对公共服务，交通以及能源等重点行业，依托新IT技术以及擎天智能引擎，为客户提供3S全栈全周期的陪伴式服务，并加速推进各领域的智能化转型升级。</p><p> </p><p>在今年1月份，联想还与信通院联合发布了《中国企业智能化成熟度报告2022》并提出了企业智能化转型成熟度模型以及企业智能化转型框架。针对企业智能化转型需求，联想打造了从咨询，部署到运维一站式全周期服务。</p><p>据了解，凭借端边云网智的新IT全栈服务能力，目前联想已经帮助超过200家大中型企业成功走上智能化转型之路。在以3S产品、方案和服务赋能企业智能化方面，联想已助力三一重工、徐工、陕重汽、冠捷等数百家中国大型企业，并形成一批可复制的灯塔案例。</p><p></p><h2>计算引领AI赋能，驱动行业智能跃升</h2><p></p><p></p><p>除了赋能行业智能化转型的场景解决方案外，此次开放日也展现了AI作为当今最具前瞻性和颠覆性的技术之一，在快速演进迭代的同时，也已开始在各个行业智能化转型过程中全面赋能算力设备、智能硬件、解决方案和服务，结合大数据模型和行业解决方案，AI正在全面改变和推进社会的智慧化进程。</p><p></p><p>在创新开放日创力加速区，联想以“AI+”为线索，展示了以机器视觉、提示学习、大模型、小样本终身学习、语音识别等多项底层AI技术赋能的多个行业解决方案。依托于新IT全栈算力布局，联想深耕两大“锚点”技术——计算与AI的研发、落地，用先进的产品与方案驱动千行百业的进一步智能化跃升。</p><p></p><p>正如算力是AI时代的基础设施，交通是当今社会发展的“大动脉”，交通强国战略下，数字交通更是我国基建重要布局。在活动现场，联想展示了机器视觉算法支持的车联网数字路口解决方案，如何基于已有的智慧交通基础设施，应用先进底层AI技术，实现了智慧交通的又一次智能升级。在计算机视觉与算法赋能下，联想利用路口已有摄像头即可进行基于单目3D检测的车流数字化；将BEV（鸟瞰图视角）进行时间空间上的融合。最终在统一框架下清晰地显示交通参与者的位置、朝向、大小、速度等。</p><p></p><p><img src=\"https://static001.infoq.cn/resource/image/7a/e7/7a33bf650a6615a594bc09bb5c8868e7.jpg\" /></p><p></p><p>“聪明”的路通往“智慧”的城。偌大的城市中，智慧园区如同一个个智慧枢纽，流转着千行百业的智能生产力。活动现场，联想展出的WisEye智慧园区视频分析解决方案，赋能了业界首个利用视频AI进行分析的闸机。使用联想自研的全栈智能视频监控分析技术，视频闸机识别范围涵盖了人脸、人体、车辆、行为等，相比于红外线方案，联想视频分析技术可以为园区的闸机提供更开阔的“视野”与智慧的“判断力”，有效避免识别不到进出行人与物品造成的安全隐患，助力园区智能化改造升级。</p><p>&nbsp;</p><p>车联网数字路口与WiseEye智慧园区视频分析解决方案带来的行业智能跃升只是联想助推千行百业智能化转型的一个缩影。活动现场，联想在智慧零售、智慧客服、智慧交通、智慧园区等领域均展出了以AI技术赋能的行业解决方案，AI赋能已经成为联想方案服务的一大亮点。并且，依托新IT架构和有AI加持的智能引擎“擎天”持续打造坚实的数字底座方案，通过计算引领AI赋能，持续构建联想方案服务在赋能行业智能化转型中的核心竞争力,在加速各行业智能化转型升级的同时，为其降本增效，实现高质量、可持续长远发展助力。</p>",
    "publish_time": "2023-06-14 10:39:58",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "百亿大表 Join 提速 300倍！Apache Doris 在约苗数据平台的实时数仓建设实践",
    "url": "https://www.infoq.cn/article/BI89vFqXgQbbAKeVbMTG",
    "summary": "<p></p><blockquote>约苗平台是国内目前最大的成人预防接种管理服务平台。近年来，随着各功能的不断完善，用户数量不断增多，越来越多注册数据、疫苗类别点击数据、页面浏览时长等数据被生成和积累，如何有效利用这些数据进行处理分析，对于约苗提高工作效率、优化运营决策有着不容小觑的作用。基于此约苗平台历经三代架构演进，最终通过 <a href=\"http://doris.apache.org/\">Apache Doris</a>\" 重构了数据平台架构，统一了数据源出口，实现了近 300 倍的查询提速，目前已在消息系统、运营平台、数据平台、日志系统中得到广泛的应用，接入近百亿的数据量，并且在持续增加中。</blockquote><p></p><p></p><p>作者 | 李俊龙，马太科技（约苗平台）研发工程师</p><p></p><p>四川马太科技有限公司是一家扎根于疾病防控领域，具有专业的研发与运营团队的互联网公司，长期致力于改善和提升中国公众疾病防控水平，助力“健康中国2030”。旗下拥有国内用户量最大的成人疾病预防信息与服务平台“约苗”（以下简称“约苗平台”）。“约苗平台”运用互联网＋模式传播健康科普知识，为疾病防控提供先进的服务和管理工具。围绕公共卫生服务机构的疾病预防业务，开展政策、疾病教育及预约服务。发展至今已是国内最大的成人预防接种管理服务平台，作为连接公共卫生服务机构与公众的桥梁，现已连接近 5000 家公共卫生服务机构和 4000 余万用户，累计提供 2000 余万次疫苗预约服务，并产生科普内容阅读数 3.3 亿次。</p><p></p><h2>业务背景</h2><p></p><p>随着约苗平台各功能的不断完善，用户数量不断增多，越来越多注册、疫苗类别点击、页面浏览时长等数据被生成和积累，如何有效利用这些数据进行处理分析，对于提高工作效率、优化运营决策、增加下单率有着不容小觑的作用，因此我们决定搭建约苗数据架构，通过数据分析处理结果赋能业务发展，从而提高企业竞争力。</p><p></p><p>基于此，我们踏上了数据架构搭建及优化之路，为满足不同场景下的数据处理和分析需求，相关场景对数据架构提出了以下几点要求：</p><p></p><p>用户行为分析 ： 通过用户浏览内容或页面的时长进行用户分层、掌握用户行为喜好，通过对新用户的增量和用户活跃度进行统计，以便工作人员调整运营策略，提高用户留存率和活跃度。在该场景下，要求所有查询需要在 5s 内返回结果。平台通知: 约苗平台消息推送服务包含 App 推送、内置通知、短信、信公众号推送，在该场景下，期望可达到毫秒级查询响应，解决 C 端通知查询延迟的问题。市场报表统计: 市场部每天需对相关业务进行报表统计，但由于数据量巨大，通常会出现查询速度较慢的问题，这将严重影响产出计算，期望可以实现秒级查询响应。</p><p></p><p>为了满足要求，约苗的数据架构已经经历了三代演进。第一代架构基于 Elasticsearch，第二代架构引入了 ClickHouse，目前正在使用的是基于 Apache Doris 的第三代架构。本文将详细介绍这三代架构的演进历程和搭建经验。</p><p></p><h2>基于 Elasticsearch 的第一代架构</h2><p></p><p><img src=\"https://static001.geekbang.org/infoq/73/73893f515ef19bb230d1c921668ee3b2.png\" /></p><p></p><p>第一代数据架构是基于 Elasticsearch 来构建的，主要用于处理来自业务各系统和日志系统的数据。其中，业务数据首先存储在 MySQL 中，然后使用 Flink CDC 对 MySQL Binlog 监听，将数据同步到 Elasticsearch 中。当展示层发起聚合请求时，Elasticsearch 中的数据进入聚合层对应的服务中实时计算，最终将结果输出到展示端。</p><p></p><p>架构搭建完后我们立即投入生产来验证效果，但在使用中我们发现 Elasticsearch 在高并发读取和写入的过程中延迟非常高，而为改善该问题，我们又增设了多套集群配置，但仍然于事无补。除此之外，Elasticsearch 得数据查询性能也会随着数据增长而下降。在这个情况下，如果想要提高 Elasticsearch 响应速度，还需进一步增加集群配置，以提高 Elasticsearch 集群负载能力，成本投入非常大。</p><p></p><h2>引入 ClickHouse 的第二代架构</h2><p></p><p><img src=\"https://static001.geekbang.org/infoq/13/13d041321c9385ba115c465c701ae384.png\" /></p><p></p><p>基于上述问题，我们对架构进行了升级。为避免架构演进对代码带来过大冲击，我们保留了第一代架构中基本的数据同步逻辑，在其基础上增加了 Apisix、Kafka、ClickHouse 同步流程，在此基础上对 Flink 同步流程进行了优化。为了降低 Elasticsearch 的压力，我们将日志数据、行为数据和文件系统数据进行了整体的迁移都 ClickHouse 。在 ClickHouse 同步流程中，我们使用 APISIX 的 Kafka-Logger 对行为采集和日志系统的数据进行直接上报，使用同步工具对上报数据进行清洗过滤，最终存储到 ClickHouse中。在使用 Flink 同步时，我们引入了 RabbitMQ 消息组件来保障数据同步的稳定性（因历史原因未使用 Kafka，建议尽量使用统一的消息队列组件）。</p><p></p><p>在使用过程中我们发现 ClickHouse 性能固然强悍，但需要不断进行调优，工程师的学习成本非常高，同时随着用户的体量的不断上升，用户活跃度的持续提高，ClickHouse 的运维管理和调优成本也逐步攀高。而过高的集群压力再次导致 C端部分业务出现数据同步和查询出现长达 5s 的延迟，这依旧没有解决根本问题。</p><p></p><h2>基于 Doris 的新一代架构</h2><p></p><p></p><h3>选择 Doris 的原因</h3><p></p><p>为彻底解决早期架构出现的问题，我们进行了深度调研，旨在选择更适合我们的实时数据仓库。在初步了解后，我们首先放弃了 Hadoop。一方面，Hadoop 的开发和运维难度较大，会增加我们的工作量；另一方面，Hadoop 更适合处理大数据量的批处理场景，而我们需要支持流批一体，以解决C端用户的查询延迟较高的问题。进一步了解之后，我们排除了 Kudu 选项。这是因为 Kudu 使用成本非常高，特别是在没有主键的情况下，Kudu 会占用大量存储资源。此外，一般情况下，为了满足读性能，Kudu 会牺牲写性能，这与我们的业务需求不符。在多方面的了解和对比后，我们发现 Apache Doris 最符合我们的要求，因为 Doris 具有以下优势：</p><p></p><p>支持更灵活的查询：Doris 可以支持灵活且多变的数据分析需求，以满足需求方针对不同群体高频次的营销活动。支持联邦查询：Apache Doris 1.2 版本推出了多源数据目录（Multi-Catalog）通过简单的命令便可以方便地连接到各自外部数据源并自动同步元数据，实现数据出口统一，实现统一的分析体验。查询性能优异：Doris Join 能力强大，依托列式存储引擎、现代的 MPP 架构、向量化查询引擎、预聚合物化视图、数据索引的实现，在低延迟和高吞吐查询上，都达到了极速性能。运维难度低：Doris 对于集群和和数据副本管理上做了很多自动化工作，使得集群运维起来非常的简单，几乎可以实现零门槛运维。与此同时，Apache Doris 社区非常活跃，响应迅速，并且 SelectDB 为社区提供了一支专职的工程师团队，免费为用户提供技术支持服务。</p><p></p><h3>数据架构的重建</h3><p></p><p><img src=\"https://static001.geekbang.org/infoq/8c/8cb32184f781f54be69f9b2c8202145a.png\" /></p><p></p><p>引入 Doris 后，我们对数据架构进行了重构，Doris 的位置及作用可从上方架构图得知。</p><p></p><p>由图可知，Doris 的数据来源非常多样化，包括通过 Flink-CDC、Binlog 的业务数据，经由 Kafka 的行为数据和日志数据，以及从自研的全量/增量工具同步的其他数据。此外，还有部分通过 Doris Stream Load 和 Routine Load 同步的数据。这些来自不同工具的数据统一由 ETL 处理，最终存储到 Kafka 或 Doris 集群中。其中存储到 Kafka 中的数据会通过 Routine Load 高效写入到 Doris 中，最终由 Doris 统一提供数据服务。Doris 的引入解决了各类同步工具的数据源统一的问题，不再需要维护大量配置，而统一数据出口也让数据处理变得更加简单和高效。</p><p></p><p>在新一代架构中，Doris 已完全取代了 ClickHouse，相比于 ClickHouse，Doris 具有更好的性能和更广泛的适用性，在约苗所服务的业务已逐步从统计分析扩展到业务系统。基于 Doris 的高性能、高并发的支持，约苗平台的用户端相关业务延迟问题也得到了成功解决，使得数据查询和分析更加及时和准确。</p><p></p><h2>新数据架构搭建经验</h2><p></p><p>在新架构的使用过程中，我们积累了许多实践经验，希望能够与大家分享。以下是我们总结出来的一些经验：</p><p></p><h2>Routine Load 实现 数据快速导入</h2><p></p><p>在数据导入方面，我们强烈建议使用 Stream Load 和 Routine Load 这两种工具，因为它们的性能远远高于其他导入方式。</p><p></p><p></p><blockquote>Stream Load 和 Routine Load 是 Doris 常见的两种数据导入方式，Stream load 是一个同步的导入方式，用户通过发送 HTTP 协议发送请求将本地文件或数据流导入到 Doris 中。Routine Load 功能支持用户提交一个常驻的导入任务，通过不断的从指定的数据源读取数据，将数据导入到 Doris 中。</blockquote><p></p><p></p><p>我们曾经尝试过其他的数据导入方式，经过多次压力测试和性能对比，并结合我们的实际数据类型，最终选择了 Stream Load 和 Routine Load 进行数据导入。Routine Load 是一种高效、稳定的数据导入工具，它依赖于 Kafka 并具有极好的可靠性。与其他数据导入方式相比，Routine Load 支持的配置丰富，能够根据配置来过滤和合并数据，同时需要开通的网络策略也更少，能够很好地满足同步数据的需求。最重要的是，Routine Load 可以达到每分钟数百万行的数据导入，完全符合我们对数据导入速度的要求。</p><p></p><p>在使用 Routine Load 进行数据导入时，难免会出现全量和增量数据同时同步的情况，或者在多线程消费下出现数据积压的情况，这就需要保证数据的一致性。因此我们可以通过 Doris 支持的 Sequence 列来保证数据的一致性，用户可以在导入时指定 Sequence 列，相同 Key 列下，REPLACE 聚合类型的列将按照 Sequence 列的值进行替换，较大值可以替换较小值，反之则无法替换。该方法将顺序的确定交给了用户，由用户控制替换顺序。具体的实现方式如下：</p><p></p><p>在定义表时，先定义一个列，比如定义为 order_id。接着在创建 Routine Load 时指定根据 order_id 列进行写入，以保证数据写入顺序。在写入数据时，需要保证每条数据都拥有 order_id 列有值。在进行全量同步时，可以使用 Java-sync 来实现，全量同步时需要保证 order_id 始终为 0。在进行增量同步时，可以使用读取 Binlog 的方式进行同步，增量同步的 order_id 需要从 1 开始。另外可以记录增量同步的 order_id 值，以保证数据准确写入 Unique 表。</p><p></p><h3>分区分桶和查询实践</h3><p></p><p>在使用 Doris 进行数据存储时，建表时需要尽量贴近实际使用场景，以此来创建分区列和分桶列。这里将分享我们我们在创建表时的一些经验。</p><p></p><p>分区：分区是建立一张大表时非常关键的因素，它直接影响到可以检索到的数据大小和需要处理的数据量。如果一个分区的数据量太大，那么就需要更多的 CPU 和内存来处理，从而导致查询效率降低。如果利用时间分区，可以考虑使用动态分区来让 Doris 自行管理分区。动态分区可以根据时间自动创建新的分区，并删除旧的分区，从而保持数据的最新性和存储效率。同时，动态分区还可以帮助我们保留部分数据或者区分冷热数据，从而更好地管理数据存储和查询。分桶：考虑在一个分区下如何让分桶足够均衡，是每个表必须要做的事情。如果分桶列数太多，可能会影响点查询的性能，如果分桶不够均衡，查询速度会受到最大桶处理时间的影响。因此需要在性能和查询需求之间做出取舍。另外，推荐大家使用Apache Doris 1.2.2 版本的<a href=\"https://mp.weixin.qq.com/s?__biz=Mzg3Njc2NDAwOA==&amp;mid=2247514115&amp;idx=1&amp;sn=e009656026c1a7eb64a345d651ce7f49&amp;chksm=cf2fb604f8583f12379675d5df9885dd84573d8c9d373606888f698045dc26ef63bca9b565be&amp;token=951557529&amp;lang=zh_CN#rd\"> Auto Bucket 自动分桶推算功能</a>\"，分桶个数不再依赖于人工设置，通过规则的智能计算即可保证合理的数据划分，降低用户学习成本的同时还可以最大化提升用户开发效率。</p><p></p><p>举例来说，当我们需要记录行为记录宽表时，一般会使用 Duplicate 模型进行记录。在建表时，我们可以把report_time、event_id、product_id、plate_id、user_id 作为 Key 列，并使用 report_time 按月进行动态分区，每月记录数据 1.5 TB 左右，使用 product_id、plate_id、event_id 进行自动分桶。</p><p></p><p>在使用过程中我们发现，当某一类事件远远超过了其他事件的总数时，会严重导致数据倾斜严重。为了解决这个问题，我们增加了在分桶列后新增了user_id，从而达到了数据均衡的效果。通过这一优化，查询速度由原来的 13s 提升到 5s。另外我们在这个基础上使用了物化视图进一步对查询性能进行优化，物化视图介入之后，查询速度从 5 秒提升到毫秒级别。</p><p></p><h2>Doris 在约苗的应用实践</h2><p></p><p></p><h3>灵活组合查询，提高广告投放效率</h3><p></p><p>由于疫苗的特殊性，业务侧同学在推广的过程中需要更精准的用户信息，例如年龄、性别、地区等业务同学指定的信息。这种情况下，数据平台就需要提供详细的用户群体信息，以帮助业务同学实现精细化信息触达。</p><p></p><p>在接入 Doris 后，我们主要利用 Doris 的 Join 实现了一套完全可以支持任意字段组合查询的工具。类似于常见的 SQL 管理工具，不同的是，无需自行编写 SQL，只需选择需要的字段进行组合配置即可查询，得到想要的结果，以此来满足需求多变的业务场景，从而提高业务侧工作效率。同时，Doris 还具有高效的数据写入和查询能力，使得运营人员可以更加快速地获取所需数据，进行数据分析和应用开发。</p><p></p><p>基于此，业务同学可以通过多种业务数据联合检索，快速筛选出满足自己需求的用户信息，并导出最终检索结果。例如，可以对年龄在 19 岁至 45 岁之间，浏览过 HPV 九价疫苗页面并且页面停留时长大于 1 分钟的用户数据进行检索，并导出结果。通过这一方式，业务同学可以快速获取目标用户信息，从而精准地进行营销推广和活动推送。</p><p></p><h2>联邦查询实践 ，百万数据分钟级导入</h2><p></p><p>在使用 Doris 之前，某些业务场景需要数据组的同事自行编写大量复杂代码来完成数据导入任务。在接入 Doris 之后，我们利用 Muti-Catalog 功能建立了 ES 和 MySQL 的外表，在遇到数据导入任务时，我们仅需要花几分钟时间编写 SQL，依靠 Doris 快速完成数据导入任务。同样的数据导入任务（80 万数据的）之前需要 1 -2 天的时间完成，而使用 Doris 之后，仅仅需要几分钟即可完成数据导入。</p><p></p><p>除此之外，Apache Doris 提供的 Multi Catalog 功能也帮助我们的统一了来自多种同步工具的数据源，成功统一了数据出口，使得数据处理变得更加简单和高效，同时我们也无需投入过多的人力和精力去维护大量其他数据相关的配置，极大的节约了成本的投入。</p><p></p><h3>Join 能力加持，实现 300 倍查询速度提升</h3><p></p><p>除此之外，Doris 的 Join 性能十分优异，当 Doris 集群完成业务数据的全同步后，我们对 1亿 和近百亿的两张表进行 Join 操作，可以在 5 秒内输出数据结果，相较之前有接近 300 倍的查询速度提升。为了验证其是否偶然，我们接着对 10 张分别有 4000万数据的表进行 Join，Doris 可以在 10s 内返回查询结果。而在物化视图加持下，可以达到毫秒级别的查询响应。这充分说明了 Doris 在处理大规模数据的优势。</p><p></p><h3>极低运维成本，助力降本提效</h3><p></p><p>在之前的架构中，我们使用 ClickHouse 进行数据存储和查询，并且需要单独维护Zookeeper 来管理集群的配置信息和状态信息，这些都增加了系统的运维成本和难度。而 Doris 架构简单，只有 FE 和 BE 两个进程，扩缩容快捷方便，运维难度和成本得到极大的降低，此外，Doris 还提供了更加友好和易用的数据备份和恢复功能，可有效保障数据的安全性和完整性。</p><p></p><h2>总结规划</h2><p></p><p>当前约苗已经基于 Apache Doris 搭建了一套完整的实时数据仓库，并在消息系统、运营平台、数据平台、日志系统中得到广泛的应用，目前已经接入百亿级别的数据量，并且在持续增加中。未来我们将基于 Doris 不断探索，扩大 Doris 使用范围，逐步推广至秒杀、订阅、黑名单、预约等各个业务场景，同时我们也将尝试使用 Doris 的新特性，以实践结果回馈社区，为社区发展献一份力，为社区做出实质性的贡献。</p><p></p>",
    "publish_time": "2023-06-14 10:55:23",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "蚂蚁集团数字科技部云原生中间件技术总监王磊确认出席 ArchSummit 深圳",
    "url": "https://www.infoq.cn/article/UmZzrRyGuFKP0R6fBCkx",
    "summary": "<p>7&nbsp;月&nbsp;21&nbsp;日&nbsp;-&nbsp;22&nbsp;日，&nbsp;在&nbsp;<a href=\"https://archsummit.infoq.cn/2023/shenzhen?utm_source=infoqweb&amp;utm_medium=teacherarticle&amp;utm_campaign=8&amp;utm_term=0531\">ArchSummit&nbsp;全球架构师峰会（深圳站）</a>\"，蚂蚁集团数字科技部云原生中间件技术总监王磊，将于会上发表题为《Mesh&nbsp;是下一代分布式软件的必经之路》主题分享，总结、提出分布式架构带来的问题，并介绍蚂蚁集团利用&nbsp;Mesh&nbsp;技术来解决它们的实践经验。</p><p></p><p>王磊是蚂蚁中间件团队第一代成员，在中间件技术领域耕耘&nbsp;10&nbsp;几年，创立了蚂蚁数字科技云原生技术团队，蚂蚁单元化架构主要设计者之一。目前在蚂蚁集团主要负责云原生技术发展，致力于在全行业推广以&nbsp;Mesh&nbsp;为主的云原生技术，推动行业伙伴共同用云原生&nbsp;Mesh&nbsp;解决复杂技术难题。</p><p></p><p>相信通过王磊的分享，你将了解蚂蚁&nbsp;Mesh&nbsp;技术的实践细节，认识到&nbsp;Mesh&nbsp;技术能带来的技术收益和业务价值。</p><p></p><p>除上述专题外&nbsp;，ArchSummit&nbsp;深圳还将围绕<a href=\"https://archsummit.infoq.cn/2023/shenzhen/track/1537?utm_source=infoqweb&amp;utm_medium=teacherarticle&amp;utm_campaign=8&amp;utm_term=0531\">基础架构技术</a>\"、<a href=\"https://archsummit.infoq.cn/2023/shenzhen/track/1532?utm_source=infoqweb&amp;utm_medium=teacherarticle&amp;utm_campaign=8&amp;utm_term=0531\">DataOps、Data&nbsp;Fabric&nbsp;等高效数据开发与服务模式</a>\"、<a href=\"https://archsummit.infoq.cn/2023/shenzhen/track/1534?utm_source=infoqweb&amp;utm_medium=teacherarticle&amp;utm_campaign=8&amp;utm_term=0531\">Mesh&nbsp;技术实践案例</a>\"、<a href=\"https://archsummit.infoq.cn/2023/shenzhen/track/1535?utm_source=infoqweb&amp;utm_medium=teacherarticle&amp;utm_campaign=8&amp;utm_term=0531\">QUIC&nbsp;传输和架构优化</a>\"等进行分享。</p><p></p><p>数十位业界专家，上百个国内外一线大厂前沿技术案例，一定会给你带来很多全新的开发灵感。期待与你线下交流！&nbsp;现在购票，享&nbsp;9&nbsp;折特惠，立省&nbsp;¥880！咨询购票请联系&nbsp;18514549229（微信同手机号）</p><p><img src=\"https://static001.infoq.cn/resource/image/9d/aa/9d6a27547062ee2e089f91bdc4ba1eaa.png\" /></p><p></p>",
    "publish_time": "2023-06-14 11:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  }
]