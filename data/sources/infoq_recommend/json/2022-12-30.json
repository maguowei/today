[
  {
    "title": "亚马逊云科技为蓝绿及金丝雀策略引入CloudFront持续部署",
    "url": "https://www.infoq.cn/article/LW5JeoLR0Jcl1ktRNV0o",
    "summary": "<p>亚马逊云科技宣布CloudFront现已支持<a href=\"https://aws.amazon.com/about-aws/whats-new/2022/11/amazon-cloudfront-continuous-deployment-support/\">持续部署</a>\"，可用部分实时流量测试并验证配置变化。AWS内容交付网络的新功能简化了蓝绿及金丝雀部署策略。</p><p></p><p><a href=\"https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Introduction.html\">CloudFront</a>\"的持续部署是为部署后验证、向后兼容，仅使用小部分请求验证新功能等场景而设计。AWS高级解决方案架构师<a href=\"https://www.linkedin.com/in/joe-v-3428806/\">Joe Viggiano</a>\"，首席解决方案架构师<a href=\"https://www.linkedin.com/in/johnsoncarlp/\">Carl Johnson</a>\"，以及首席产品经理Vishal Anand如此<a href=\"https://aws.amazon.com/blogs/networking-and-content-delivery/use-cloudfront-continuous-deployment-to-safely-validate-cdn-changes/\">解释</a>\"：</p><p></p><blockquote>当前行业上对于测试CDN配置变化已有的解决方案是需要在客户端注入自定义头信息、覆盖客户端DNS设置，或者实施单独的测试域。这一切都让大规模测试充满挑战。客户可能会不得不在应用程序中建立复杂的功能标志（……）这种方式缺乏可扩展性，且不能百分百引导生产流量，无法确保新引入的变化不会对工作负载产生负面影响。</blockquote><p></p><p>&nbsp;</p><p>借助CloudFront的持续部署，客户向主要分布中发送请求，CloudFront基于<a href=\"https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/continuous-deployment.html\">持续部署策略</a>\"中的权重或头配置，将其中部分请求路由到暂存分布。基于权重的配置会将特定百分比（最高可至15%）的Viewer请求路由到暂存分布，而基于头的配置则会根据特定HTTP头将请求路由到暂存分布。</p><p></p><p></p><p><img src=\"https://static001.geekbang.org/infoq/78/7830cd8341e2182a6a59a1e28dc0bee9.png\" /></p><p></p><p>来源：<a href=\"https://aws.amazon.com/blogs/networking-and-content-delivery/use-cloudfront-continuous-deployment-to-safely-validate-cdn-changes/\">https://aws.amazon.com/blogs/networking-and-content-delivery/use-cloudfront-continuous-deployment-to-safely-validate-cdn-changes/</a>\"</p><p>&nbsp;</p><p>两种方式都可用于测试同一部署，以基于头的配置验证已知测试用户和设备的第一条变更，随后在借助基于权重的配置引入生产流量。这一功能通过将Viewer会话与环境绑定，让监控标准及实时日志变得可行，一旦变更对服务有影响，可即时回滚回先前的配置。Viggiano、Johnson及Anand写道：</p><p>&nbsp;</p><p></p><blockquote>在需要进行测试时，CloudFront现在允许创建一个与生产分布相关联的暂存分布 。可在暂存分布中修改原点、原点组、缓存行为、客户错误响应、默认根对象、日志和地理限制等设置，未来还会增加更多可更改的设置项。</blockquote><p></p><p>&nbsp;</p><p>开发者们对于AWS CDN上对蓝绿及金丝雀部署的支持期盼已久，无论是在<a href=\"https://www.reddit.com/r/aws/comments/ix8l52/what_is_the_status_on_doing_bluegreen_deployments/\">红迪</a>\"还是<a href=\"https://serverfault.com/questions/714742/blue-green-deployments-with-cloudfront\">Server Fault</a>\"上都有很多讨论串。云顾问及AWS无服务英雄<a href=\"https://www.linkedin.com/in/theburningmonk/\">Yan Cui</a>\"则对这个<a href=\"https://twitter.com/theburningmonk/status/1595054650629427206\">名称</a>\"发出来质疑：</p><p></p><blockquote>非常赞，但我不太理解为什么要叫CloudFront“持续部署”，而不是叫CloudFront金丝雀部署之类的名字。</blockquote><p></p><p>&nbsp;</p><p>主要分布和暂存分布不共享缓存。在资源使用高峰期，CloudFront可能会无视持续部署策略，将所有请求全部发送到主要分布。基于当前限制，CloudFront持续部署不支持<a href=\"https://www.infoq.com/news/2022/08/amazon-cloudfront-http3/\">启用了HTTP/3</a>\"的分布。</p><p>&nbsp;</p><p>该新功能可在所有AWS边缘，通过控制台、SDK、CLI或CloudFormation模板使用。</p><p>&nbsp;</p><p>原文链接：</p><p><a href=\"https://www.infoq.com/news/2022/11/aws-cloudfront-continuous/\">AWS Introduces CloudFront Continuous Deployment for Blue-Green and Canary Strategies by Renato Losio</a>\"</p><p></p><p>相关阅读：</p><p><a href=\"https://www.infoq.cn/article/IjopWm7HUlP8qftzbOB3\">AWS Lambda 现可支持 Node.js 18 运行时</a>\"</p><p><a href=\"https://www.infoq.cn/article/O9jijEFIBtaaeecQCe8K\">亚马逊云科技向 Well-Architected Framework 添加容器透镜</a>\"</p>",
    "publish_time": "2022-12-30 08:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  }
]