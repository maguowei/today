[
  {
    "title": "DoorDash重构多层缓存系统，提高性能并解决碎片化问题",
    "url": "https://www.infoq.cn/article/lFbaXCiRFqWOPgstNZHi",
    "summary": "<p>DoorDash重构了他们在所有微服务中使用的异构缓存系统，<a href=\"https://doordash.engineering/2023/10/19/how-doordash-standardized-and-improved-microservices-caching/\">创建了一个通用的多层缓存</a>\"，提供了一种通用的机制，解决了因采用碎片化缓存所带来的诸多问题。</p><p>&nbsp;</p><p>缓存是一种常用的机制，不需要进行成本高昂的优化就可以提升系统的性能。DoorDash工程师Lev Neiman和Jason Fan解释说，这在DoorDash的场景中尤为重要，因为对他们来说，实现业务逻辑比优化性能更重要。</p><p>&nbsp;</p><p>遗憾的是，DoorDash的不同团队使用了不同的缓存系统，包括<a href=\"https://github.com/ben-manes/caffeine\">Caffeine</a>\"、<a href=\"https://redis.io/\">Redis Lettuce</a>\"和HashMap。这也意味着他们会一次又一次地经历和解决同样的问题，比如缓存过期、严重依赖Redis、键模式不一致等。出于这个原因，DoorDash的一个工程师团队开始为他们所有的微服务创建一个共享缓存库，从DashPass开始，这是一个由于流量增加而面临扩展挑战和频繁故障的关键服务。</p><p>&nbsp;</p><p>第一步是基于两个Kotlin接口定义一个公共API：CacheManager，为特定的键类型和回退方法创建新的缓存；CacheKey类，对键类型进行抽象。</p><p></p><p></p><blockquote>这让我们可以使用依赖注入和多态性在后台注入任意逻辑，同时保持业务逻辑缓存调用的统一性。</blockquote><p></p><p>&nbsp;</p><p>在尽力保持缓存简单的同时，DoorDash工程师选择了一种包含三层的多层设计，进一步提高性能优化的可能性。第一层称为请求本地缓存，数据驻留在哈希映射中，其生存期受请求约束。第二层为本地缓存，使用Caffeine在同一Java虚拟机的所有工作线程之间共享数据。第三层是Redis缓存，同一Redis集群中的所有pod都可以使用Redis Lettuce访问。</p><p>&nbsp;</p><p>这个多层缓存系统的一个重要特性是运行时控制，每个层都有，可以打开或关闭缓存，设置缓存生存时间（TTL）或是影子模式（在这种模式下，会将一定比例的缓存请求与真实来源进行比较）。此外，缓存系统还支持指标收集，包括命中和未命中、缓存延迟和日志记录。</p><p>&nbsp;</p><p>在缓存系统准备就绪并在DashPass中达到预期效果后，他们就把它逐步推广到组织的其他部门，并就何时使用、如何使用或者是何时不使用提供明确的指导。</p><p>&nbsp;</p><p>根据Neiman和Fan的说法，新的缓存系统提高了他们所有服务的可扩展性和安全性，同时也方便了团队在必要时采用缓存来提高性能。</p><p>&nbsp;</p><p>&nbsp;</p><p>原文链接：</p><p><a href=\"https://www.infoq.com/news/2023/10/doordash-multilayered-cache/\">https://www.infoq.com/news/2023/10/doordash-multilayered-cache/</a>\"</p>",
    "publish_time": "2023-11-10 08:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "国泰君安证券数据平台运营部副总经理苑博确认出席 FCon，分享国泰君安证券数据人才能力提升 1+N+X 创新模式及应用",
    "url": "https://www.infoq.cn/article/9gZ2YTCB0LNFi8iFctgW",
    "summary": "<p><a href=\"https://fcon.infoq.cn/2023/shanghai/?utm_source=infoqweb&amp;utm_medium=atricle\">FCon 全球金融科技大会</a>\"，将于 11 月在上海召开。国泰君安证券数据平台运营部副总经理苑博将发表题为《<a href=\"https://fcon.infoq.cn/2023/shanghai/presentation/5624?utm_source=infoqweb&amp;utm_medium=article\">国泰君安证券数据人才能力提升 1+N+X 创新模式及应用</a>\"》主题分享，介绍数据人才能力提升 1+N+X 创新模式方法论和数据文化建设体系。</p><p></p><p><a href=\"https://fcon.infoq.cn/2023/shanghai/presentation/5624?utm_source=infoqweb&amp;utm_medium=article\">苑博</a>\"，国泰君安证券数据平台运营部副总经理。证标委业务标准化委员会专家组成员，上海国资委大数据治理及应用课题专家。在证券公司客户关系管理、风险管理、自营交易、大数据和人工智能平台建设和运营、企业数据仓库及数据治理等领域具有多年工作经验，带领团队制定多项行业标准并获得多次技术创新奖项。他在本次会议的演讲内容如下：</p><p></p><p>演讲：国泰君安证券数据人才能力提升 1+N+X 创新模式及应用</p><p></p><p>在证券行业数字化转型的浪潮下，传统金融业务正在与数据进行深度融合，加速证券行业平台化、智能化、数智化的发展。国泰君安坚持客户至上，坚守长期主义，以高质量的财富管理转型发展服务国家共同富裕战略，加快构建“投顾驱动，科技赋能”财富管理 2.0 模式。以客户为中心，全面提升千人千面、敏捷智能的客户体验，推动一线客户经理向财富管理专业投顾、分支机构向资产配置为导向的买方服务模式转型。在此基础上，提升全集团数据人才能力，打造总部、分支机构、子公司数据人才矩阵，全方位赋能集团高质量发展成为必不可缺的一环。</p><p></p><p>演讲提纲：</p><p></p><p>项目背景介绍</p><p></p><p>○ 传统金融业务与数据进行深度融合后，能更好的响应用户需求，实现用户的服务体验提升。</p><p>○ 集团全面数字化转型离不开转型过程中全价值链上的各个环节数据人才的参与</p><p></p><p>1+N+X 数据人才数据人才能力提升创新模式</p><p></p><p>○ 1：一个统一的智慧化数据中台</p><p>○ N：培养 N 个集团数据分析核心用户，通过线上 + 线下的方式，培养数据人才</p><p>○ X：吸引 X 个数据产品用户，通过经营管理驾驶舱、智能报表、经营指标卡、企业画像、数据学堂等产品打造全方位数据产品矩阵，吸引更多集团用户参与到数据价值的挖掘中来</p><p></p><p>项目成果和效益</p><p></p><p>○ 打造“有数、用数、治数”良性循环</p><p>○ 培养超过 500 个集团数据分析师</p><p>○ 吸引超过 8000 个活跃数据产品用户</p><p></p><p>总结和展望</p><p></p><p>你将获得：</p><p></p><p>国泰君安证券数据人才能力提升 1+N+X 创新模式方法论国泰君安数据文化建设体系</p><p></p><p>除上述演讲外，FCon 上海还将围绕&nbsp;<a href=\"https://fcon.infoq.cn/2023/shanghai/track/1580?utm_source=infoqweb&amp;utm_medium=atricle\">DevOps&nbsp;在金融企业落地实践</a>\"、<a href=\"https://fcon.infoq.cn/2023/shanghai/track/1591?utm_source=infoqweb&amp;utm_medium=atricle\">金融行业大模型应用</a>\"、<a href=\"https://fcon.infoq.cn/2023/shanghai/track/1576?utm_source=infoqweb&amp;utm_medium=atricle\">创新的金融科技应用</a>\"、<a href=\"https://fcon.infoq.cn/2023/shanghai/track/1577?utm_source=infoqweb&amp;utm_medium=atricle\">金融实时数据平台建设之路</a>\"、<a href=\"https://fcon.infoq.cn/2023/shanghai/track/1588?utm_source=infoqweb&amp;utm_medium=atricle\">金融安全风险管控</a>\"、<a href=\"https://fcon.infoq.cn/2023/shanghai/track/1589?utm_source=infoqweb&amp;utm_medium=atricle\">数据要素流通与数据合规</a>\"等进行交流。</p><p></p><p>FCon 上海 2023，相约 11 月！大会 8 折优惠报名倒计时仅剩最后 1 天，现在购票立减￥1360。咨询购票请联系：17310043226（微信同手机号）。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/a8/a8ec7f7fb25c7949931b2b8a5deffddd.png\" /></p><p></p>",
    "publish_time": "2023-11-10 11:30:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "保利威成为 FCon 全球金融科技大会特邀支持单位",
    "url": "https://www.infoq.cn/article/wDYx6mB5hQYLEmd7Qhjo",
    "summary": "<p>11&nbsp;月&nbsp;19-20&nbsp;日，InfoQ&nbsp;中国旗下首届<a href=\"https://fcon.infoq.cn/2023/shanghai/\">FCon全球金融科技大会</a>\"将在上海中谷小南国花园酒店盛大开幕，金融企业级视频运营服务商<a href=\"https://www.polyv.net/\">保利威</a>\"成为特邀视频直播支持单位，助力大会顺利举办。</p><p></p><p><img src=\"https://admin.geekbang.org/message/image/url?templ_id=156&amp;file=%E4%BF%9D%E5%88%A9%E5%A8%81.jpeg&amp;task_id=0&amp;sign=0.70\" /></p><p>&nbsp;</p><p>关于&nbsp;保利威</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/92/922d30dc8910862ddabbfafea0952974.png\" /></p><p></p><p>保利威成立于 2013 年，致力于为企业提供基于技术和运营的新媒体视频综合服务，助力企业构建品牌全场景直播矩阵。</p><p></p><p>保利威目前已服务超过 25 万企业级用户，深度服务银行、证券、保险、高科技制造、教育及众多大型国央企，年落地超过 650 万场直播，2020-2023 连续 4 年获评“中国企业直播服务商”排行榜第一名。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/a4/a477e1e526e933a85bc5838e1565e373.png\" /></p><p></p><p>保利威金融直播解决方案可一站式搭建金融直播系统，适用于金融品牌推广、金融营销、数字化培训等场景。满足简便易用、系统稳定、安全合规等金融类直播需求。拥有 PlaySafe® 独家视频版权保护技术和深度视频数据分析技术、获非金融机构最高级别网络安全认证【国家网络安全等级保护三级认证】，平台稳定性达到 99.99%。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/49/49c0b16070d2ea5bf3b3204331f434f5.png\" /></p><p>保利威已服务25万+企业级客户</p><p>&nbsp;</p><p>官网地址：<a href=\"https://www.polyv.net/?utm_source=infoq\">https://www.polyv.net/</a>\"</p><p>&nbsp;</p><p>关于 FCon</p><p>&nbsp;</p><p>FCon 全球金融科技大会是极客邦科技旗下 InfoQ 中国团队推出的面向金融行业高端技术管理者、技术专家的会议，50% 参会者拥有 8 年及以上工作经验。</p><p>&nbsp;</p><p>FCon 聚焦当前金融行业遇到的问题，围绕金融企业在数字化转型过程中的痛点，例如数据治理、智能化、数字化风控、数字化投研、数字化营销、IT 技术能力等方向，邀请国内外金融企业，来分享人工智能、区块链、大模型、大数据、数字货币等新一代信息技术实践话题，帮助听众解决技术和业务上的问题，提升技术能力。</p><p>&nbsp;</p><p>下周日，以「科技+金融，激发创新力量」为主题的首届 FCon 将盛大开幕，近百家金融行业龙头企业齐聚上海，探讨大模型在金融领域的落地难点。</p><p>&nbsp;</p><p>目前中国银联、招商银行、中国工商银行、中国民生银行、平安银行、兴业银行、中信银行、北京银行、上海华瑞银行、苏州银行、东亚银行（中国）有限公司、汇丰银行、汇丰科技、富滇银行、花旗银行、杭州银行、联邦银行、玉山银行、微众银行、广发银行信用中心、万事达卡（Mastercard）实验室、广发证券、国泰君安证券、平安人寿、平安集团、平安科技、太平洋健康险、阳光保险集团、微民保险、亿保健康、中体彩、平安养老保险、中邮消费金融、建信金科、光大信托、德邦基金、天弘基金、杭银消费金融、湖南财信、中金所、恒生电子、嘉银金科、金融电子结算中心、马上消费、广东盈峰普惠互联小额贷款股份有限公司中国信通院、中国软件评测中心、宇谷金融科技研究院、华东政法大学、重庆工程学院、度小满、蚂蚁集团、火山引擎、腾讯云、声网、恒生聚源、创邻科技、同盾科技、信也科技、飞轮科技、中关村科金、奇富科技、AuxBridge、Daraz、Kyligence、北京安捷数科信息技术有限公司、合合信息、神州数码、滴滴、顶针、国网信息、华为、科大讯飞、乐刷科技、联洋国际、字节跳动、宇信科技、腾讯、数禾信息等公司的数百位技术高管，将莅临现场参与本次盛会。<a href=\"https://fcon.infoq.cn/2023/shanghai/schedule\">&gt;&gt;查看详细日程</a>\"</p><p></p><p>目前大会 8 折优惠报名倒计时 1 天，现在购票立减 ¥1360，使用 polyv 口令购票可在当钱折扣期基础上再减 1 折。<a href=\"https://fcon.infoq.cn/2023/shanghai/apply\">&gt;&gt;立即报名</a>\"</p><p></p><p>更多优惠信息可联系票务经理 17310043226。5 场主会场巅峰对话，11 个专题精彩分享，5 大闭门深度研讨，1 场晚场轻松交流，这是属于金融行业技术人的年终盛会，11 月 19-20 日，上海见。</p>",
    "publish_time": "2023-11-10 11:41:24",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "数字化智能时代，提升研发效能的最优路径是什么？",
    "url": "https://www.infoq.cn/article/sabYKDxIINRLcwmbcWsY",
    "summary": "<p>在数字化智能时代，各行业对高效研发的需求日益增强。从早期的敏捷开发、CI/CD工程化流水线到DevOps、DevSecOps、GitOps、DataOps、AIOps甚至NoOps，不同的工具和平台都是为了优化软件生产的生命周期，以及提升组织的响应效率而生。</p><p>&nbsp;</p><p>然而现实情况却是，在业务驱动的研发过程中总会面临多个环节的挑战，例如云平台在运维中的承载量问题、数据库配置与变更管理问题，以及软件开发方式的问题等。因此，想要改变这一现状，就要在多环节找到影响研发效能提升的问题所在和解决路径。那么，如何提升研发效能便成为大家深入探讨的话题。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/fc/fc0b59b6e4eef07cc40973bdd047d881.png\" /></p><p>11月4日，InfoQ技术公开课邀请到了汇丰科技云与DevOps中国区总监刘华、汇丰科技云平台高级专家顾问陈庆佳、汇丰科技市场与证券服务科技部后端研发工程师吴哲、汇丰科技软件工程副经理杨珂、汇丰科技人力资源助理副总裁梁培之五位专家坐镇，以不同的视角分享“提升研发效能”话题。</p><p>&nbsp;</p><p>五位专家围绕三大议题来分享云平台自动运维的创新之路，数据库平台解决方案的重要突破，软件开发方法的探索实践的相关话题，并解读汇丰科技企业人才培养攻略。本期线上分享会的主题为“云原生时代，揭秘提升研发效能的最优路径”，主持人为InfoQ策划编辑桑红妍，以下为直播内容精编整理。</p><p></p><h2>《云平台自动化运维的技术探索与实践》</h2><p></p><p>汇丰科技云与DevOps中国区总监 刘华</p><p>汇丰科技云平台高级专家顾问 陈庆佳</p><p>&nbsp;</p><p>汇丰科技是汇丰集团的一部分，汇丰集团是全球规模最大的银行和金融服务机构之一，目标是成为客户首选的国际金融合作伙伴。目前，汇丰集团有三大环球业务包括：财富管理及个人银行业务，工商金融，环球银行及资本市场。在全球拥有超过3900百万的客户，遍布62个国家和地区。</p><p>&nbsp;</p><p>成立于2006年的汇丰科技中国拥有上万名技术人员，在广州和西安均设有科技中心，在上海设有技术服务团队，主要为汇丰全球业务及职能部门提供全面的端到端资讯科技服务，涵盖用户体验设计、业务分析、软件开发、测试、部署与维护，以及资讯科技基础设施支持。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/1a/1a9379737afa21c63ab71983ef0c7a18.png\" /></p><p>▲汇丰科技策略Vision’27</p><p>&nbsp;</p><p>汇丰科技始终致力于把汇丰集团转型为数字化优先的银行，为客户提供更好的下一代银行服务。近年来，汇丰科技开始实施一个革命性的银行科技策略，即Vision’27。该策略致力于通过四大支柱和14个全球计划，全面提升汇丰集团的IT技术建设和核心技术能力。以下是汇丰科技策略Vision’27的四大支柱：</p><p></p><p>Speed——DevSecOps模型提高了开发人员体验和交付效率，运维请求自动化为用户的请求提供实时响应。Scale——所有自动化和自助服务都改善了用户的上云体验，促进用户对云的拥抱，也满足汇丰集团内部的云优先策略。Resilience——所有自动化和自助服务让云平台能为更多的用户提供及时服务。People——DevSecOps模型使自动化团队拥DevSecOps文化。所有自动化和自助服务让原来从事手工运维的成员有机会参与到自动化开发工作，提升人员的整体能力。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/08/08a9a41d8cdb9bcd2baccccfa8a10408.png\" /></p><p>▲汇丰科技的服务和产品</p><p>&nbsp;</p><p>作为云平台的提供方，汇丰科技为各业务系统的开发交付团队和运维团队提供一个安全、合规和友好的云平台。作为一个强监管行业，汇丰科技会在平台上面进行合规和安全方面的管控。此外，汇丰科技给用户提供技术支持，包括创建新的云环境、授权、培训，以及解惑的工作。</p><p>&nbsp;</p><p>基于汇丰科技优异的研发能力，实现了五大维度的成果：</p><p>运维请求的自动化</p><p>在2023年，汇丰科技通过标准化操作流程，实现自助服务和自动化，手工运维工单数量减少了62%。汇丰科技为用户提供自助服务API来代替手动运维操作，每月减少43%的手动运维请求和数千分钟的操作工作。从而实现用户请求得到立即响应，用户体验得到大幅提升。</p><p>自研上云门户网站</p><p>通过汇丰科技自主开发的上云门户网站，将复杂的流程简单化，用户只需要填入一些必要信息，其他信息由中央系统集成获取，从而拥有一套可信完整的数据源，建立实时可视化的报表，能够更快、更简洁的完成整个上云流程，获取更好的上云之旅。</p><p>合规自动化</p><p>汇丰科技的使命是保护云平台，满足各种合规和安全的要求。为此，汇丰科技开发了大量的Compliance Check合规自动化程序，Vulnerability Check漏洞扫描程序，并且引入Airflow任务编排的平台，从而实现高可用能力。</p><p>平台API自动测试框架</p><p>为了确保云平台升级的稳定性，汇丰科技编写的API自动测试框架，每晚运行以监控云平台API的运行状况。同时，Terraform测试每天运行，以监控Terraform Provider的稳定性。</p><p>构建DevSecOps模型</p><p>CI中集成了静态代码质量扫描和Checkmarx，以提高我们的代码质量并实现DevSecOps。与此同时，汇丰科技自动化运维CR的准备流程，把每日运维CR的准备的时间从十分钟缩短到几秒钟。自动化发布使我们能够在无需人工交互的情况下，对每个用户故事进行单独发布，从而将发布范围缩小，风险降到最低。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/e7/e7b19f6203e989c7c500f71ccdc38576.png\" /></p><p>▲汇丰科技的技术全栈图</p><p>&nbsp;</p><p>关于技术全栈图，汇丰科技云平台高级专家顾问陈庆佳做出详细介绍：</p><p>&nbsp;</p><p>截至目前，汇丰科技团队应用在云平台主要分成三部分。第一部分，集成了多个不同类型的服务在同一台虚拟机当中，称之为Misc Services。第二部分，汇丰科技定制的Airflow平台，Airflow是一个高效的工作流编排工具。第三部分是汇丰科技提供的代理服务器的功能。</p><p></p><h2>《解码针对PostgreSQL的DBaaS数据库平台解决方案》</h2><p></p><p>汇丰科技市场与证券服务科技部后端研发工程师 吴哲</p><p>&nbsp;</p><p>基于Vision’27的战略定位，汇丰科技希望借助全球化集团优势，带来更多领先的创新产品与数字化解决方案，加速产业转型升级。汇丰科技市场与证券服务科技部后端研发工程师吴哲解读了针对PostgreSQL的DBaaS数据库平台解决方案，分享汇丰科技对PostgreSQL的创新应用：</p><p>&nbsp;</p><p>出于对开源节流，以及DevOps转型与实践的考虑，汇丰科技决定将Oracle数据库向PostgreSQL数据库进行迁移。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/e4/e434dce26e58e320f2b176cbfd55998d.png\" /></p><p>▲PostgreSQL方案背景</p><p>&nbsp;</p><p>前期，汇丰科技在使用PostgreSQL时，采用的是比较简单粗暴的模式。项目组需要拥有和维护自己的PG，我们团队使用的是微服务架构，提倡每一个数据库对应仅且一个微服务，从而减少服务之间的依赖，加速交付。</p><p>&nbsp;</p><p>随着DevOps实践的加深，汇丰科技提出了第一代基于PostgreSQL的平台化解决方案，该方案提供一套代码层面的抽象，实现PG数据库管理维护相关的功能。项目组可以自行fork这套代码，进行部署和维护。</p><p>&nbsp;</p><p>近期，随着我们团队对PG数据库的使用，以及DevOps实践的持续加深，汇丰科技提出了针对于PostgreSQL的DBaaS数据库平台解决方案。该方案提供托管PG功能，用户可以通过API的方式获取PG数据库，并对数据库进行集中管理，具备数据库监控与预警功能。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/16/16dbfd660093968be1beda365ce3ed92.png\" /></p><p>▲PG方案的特性与实现</p><p>&nbsp;</p><p>总的来说，PostgreSQL方案拥有使用简单、数据/服务恢复力、可对数据库进行点时间修复、数据安全的四个特性。具体而言，用户无需自己配置硬件，即可安装/升级PG。还可以采用API的方式去获取PG数据库，平台提供处理灾难恢复和监控与预警功能。</p><p>&nbsp;</p><p>谈及未来规划，汇丰科技正在研发一个高可用解决方案。目前，我们是半自动的灾难恢复机制，研发一套自动的恢复机制可以去应对更复杂的业务需求，这个实现我们使用了raft算法去解决主从集群的分布式共识问题。</p><p>&nbsp;</p><p>与此同时，汇丰科技的PG实例会部署在KVM里面。不同物理机的KVM实例不允许互相访问，所以我们需要在每一个物理机的KVM之外，搭建一个proxy解决连接的问题。</p><p>&nbsp;</p><p>近期，汇丰科技还在规划推出一款AI助手（ChatGPT）。AI助手计划具备两个功能，一个针对数据库监控场景，用户可以通过和AI助手聊天去询问数据库的相关监控信息。另一个针对新手的使用场景，AI助手可以指导新用户使用，让整个使用流程变得更加简单高效。</p><p>&nbsp;</p><p>面向远期规划，也就是RESTfulPG的构想。如果能够有一个RESTfulPG的服务，它将能够简化数据库访问，不再需要引入复杂的数据库驱动或者是相应的数据库，应用程序可以通过一个通用的http客户端与数据库交互，这其中体现了跨编程语言的兼容性。&nbsp;</p><p></p><h2>《探索Mob编程在汇丰科技的应用之道》</h2><p></p><p>汇丰科技软件工程副经理 杨珂</p><p>&nbsp;</p><p>众所周知，良好的团队协作往往可以事半功倍，最大限度的提升工作效能，更好的促进团队职责的履行。在分享了汇丰科技的革命性策略、产品和服务、解决方案之后，如何利用Mob编程来提高工作质量，成为新的议题。</p><p>&nbsp;</p><p>什么是Mob编程？Mob编程对于企业提升研发效能有什么影响？如何开展Mob编程？Mob编程在汇丰科技的应用实践以及带来了哪些价值？围绕这些问题，汇丰科技软件工程副经理杨珂进行了分享：</p><p>&nbsp;</p><p>Mob编程是一种软件开发方法，整个团队在同一时间、同一空间和同一台计算机上处理同一件事。因此，Mob编程涉及整个团队在一台计算机上一起编码，从而增强协作，主要优势包括集体代码所有权、知识共享和更快的问题解决，同时也存在一些挑战比如协调、技能平衡和工作空间等。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/0e/0e79159793aa2044f0634e7d527d02c9.png\" /></p><p>▲汇丰科技Mob编程的实践场景</p><p>&nbsp;</p><p>上图是汇丰科技相关团队实现Mob编程的场景，目前的方式是两周一个迭代，团队会在两周中选择两天作为Mob day。在开迭代计划会议时，我们会选择好适合Mob编程的主题，根据主题提前做一些相关的准备工作，以确保Mob day的顺利进行。</p><p>&nbsp;</p><p>开展Mob编程需要遵循几个基本原则：团队规模尽量保持在三到六个人，并且这些人拥有能够完成目标任务所需的技能；团队成员中会有导航者和执行者两种角色；角色之间的轮转周期控制在10-15分钟；在工作场所的选择上，需要选择一些更能适合Mob场景的硬件，从而保证大家清晰的看到目前发生的事情。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/f1/f17666d9d790c654718ce8e2c892f61c.png\" /></p><p>▲汇丰科技Mob编程的经验教训</p><p>&nbsp;</p><p>汇丰科技探索Mob编程的过程并非一帆风顺，经历了许多坎坷和曲折，最终才摸索出一套适合团队自己的编程之路。其中有成功和失败，困难与挑战，也有经验教训。</p><p>&nbsp;</p><p>在成功案例里，汇丰科技完成了用户故事的交付，生产问题的紧急修复，技术战略削减和工具提升。</p><p>&nbsp;</p><p>在失败案例里，前期需要大量的技术预研工作，或者日常运维任务，再或者过于复杂的端到端业务流，上下游系统有过多的依赖等场景均不适用于开展Mob编程。</p><p>&nbsp;</p><p>在整个Mob编程的实践中，团队遇到最多的困难和挑战是把所有需要的角色都协调到Mob day，很难在同一时间协调所有需要的角色，特别是产品负责人和架构师。此外，短时间内协调不同的意见和建议存在困难，远程Mob编程的效果也不太理想。</p><p>&nbsp;</p><p>在Mob编程的实践过程中，汇丰科技总结出了一些经验教训。建议刚开始需要一个主持人来把控节奏；15分钟的轮转时间完全不够用，可以适当增加时间；执行者也可以参与思考和讨论；过于细小和直接的工作不适合Mob编程；需要严格执行休息时间。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/ef/ef9ec44217a996f53f8a8ab225edba72.png\" /></p><p>▲Mob编程带来的收益</p><p>&nbsp;</p><p>通过Mob编程，汇丰科技完成用户故事的交付从两周时间缩减到一到三天。在工作效率方面，我们从衡量传统的人力资源效率改为衡量流转效率（flow time）。</p><p>因为是集众人之智慧于一体而写出来的代码，所以代码变得越来越标准和统一，从而提高了代码的规范性，可读性，可维护性。</p><p>&nbsp;</p><p>Mob编程是一个知识的传递与分享的过程，有利于个人和团队的成长，增强团队的归属感和凝聚力，提升团队成员的满意度。</p><p></p><h2>《汇丰科技企业人才培养攻略》</h2><p></p><p>汇丰科技人力资源助理副总裁 人才招聘 梁培之</p><p>&nbsp;</p><p>毫无疑问，发展是第一要务，人才是第一资源，创新是第一动力。汇丰科技的快速发展，离不开对人才体系的重视和布局。汇丰科技一直以来都非常重视人才队伍的培养和管理，员工晋升通道多元化，积极给优秀的人才提供发挥才能的舞台和良好的福利。</p><p>&nbsp;</p><p>关于汇丰科技的人才发展重点，以及基于人才发展的重点进行配对的学习产品，汇丰科技人力资源助理副总裁梁培之对此进行了分享：</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/b3/b363d678929b95dbe15829479712cba9.png\" /></p><p>▲汇丰科技的人才发展</p><p>&nbsp;</p><p>基于汇丰集团的业务发展战略，以及大家在过往的学习过程中所呈现的痛点，汇丰科技的人才发展的重点聚焦在支持集团的发展转型战略，通过四大学习发展支柱，为大家的成长赋能，培养具有未来视野和技能的人才。</p><p>&nbsp;</p><p>提升组织学习敏锐度，这需要整个组织共同的参与去营造持续学习，开放交流的文化，打造一个学习型的组织。变革领导力和人员管理水平，针对不同层级的团队领导者需求，定制针对性的学习产品。识别、发展和培养高潜人才，打造适应未来要求的领导人才储备，并且特别鼓励和提升女性领导力，帮助每一位女性在事业上获得发展。同步企业价值和业务产出，在进行人才培养时，汇丰科技也会和集团内部其他的社团保持同步和拉起来实现组织的共同价值，从而提升员工体验。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/97/974dd6e74a90d1b7aea37cd926a94883.png\" /></p><p>▲赋能未来的学习产品体系</p><p>&nbsp;</p><p>面向团队管理者、学习倡导者，以及个人贡献者，汇丰科技还搭建了一套完整的学习产品体系，提供不同的学习产品来满足不同人群的学习需求。上图只是汇丰科技提供给同事学习产品中的一小部分，我们会根据大家需求的变化不断的进行推陈出新，来优化我们的学习产品。</p><p>&nbsp;</p><p>汇丰集团搭建了汇丰大学（HSBC University）“一站式”丰富的在线学习资源平台，方便大家根据自己的时间还有偏好，随时随地的进行无障碍的学习。汇丰大学赋能每位汇丰科技同事，透过全方位的学习资源，涵盖技术、领域、流程、工具、方法论和工作方式，助力他们探知科技世界的广度和深度。</p><p>&nbsp;</p><p>面向即将毕业的学生或者毕业不到两年的职场新人，汇丰科技设有数字科技管培生的项目。希望可以帮助公司培养在云计算、网络、数据、人工智能等创新领域能够解决问题的人才，提升他们在这些领域的能力，为汇丰科技源源不断的注入新鲜血液。</p><p>&nbsp;</p><p>写在最后</p><p>&nbsp;</p><p>对于本届公开课，广大开发者们纷纷反馈演讲内容非常受用，切中自身要害，并且引发了对相关技术应用在自身业务场景下的思考，让他们真实了解到针对PostgreSQL的DBaaS数据库平台解决方案、开展Mob编程的重要性，也掌握了有效的人才培养方法。</p><p>&nbsp;</p><p>现如今，企业已经不能靠一味地堆砌劳动时间获得工作成果，切实提高效率才是良药，研发效能就成为了一家科技公司的核心竞争力之一。对于企业或开发人员而言，通过提高研发效能来实现降本增效的趋势愈发明显，顺势而为可获得更好发展。</p>",
    "publish_time": "2023-11-10 15:37:41",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "产品 + 工程 + 人才，网易数帆如何将数智生态方法论落地生根？",
    "url": "https://www.infoq.cn/article/hVUrBZifyZ2JwBxraKqK",
    "summary": "<p>嘉宾 | 汪源</p><p>采访｜钰莹</p><p>作者 | 吴少杰</p><p></p><p>随着全球迈入数智时代，企业的数字化转型需求日益强烈。数字化转型的实质在于推动业务发展，通过在业务的一个或多个领域进行创新和转型，使业务和技术能够实现真正的融合，达到业技一体化的目标。这一过程需要行业提出明确的需求，确保有合适的人才储备，拥有充足的技术积累，以及得到必要的资金注入和政策支持。</p><p></p><p>11 月 2 日，2023 年网易数字 + 大会在杭州正式召开。会上，网易副总裁、网易杭州研究院执行院长、网易数帆总经理汪源进行了《数智聚力 共赴新程》的主题演讲，并公布了网易数帆的全新品牌战略。针对这一最新变动，InfoQ 第一时间采访到了汪源，试图了解数智化时代，网易数帆在产业、技术、人才等方面的成果与进展。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/8d/8df0238166073e5454798bd8f9d78cd4.png\" /></p><p>图注：网易数帆品牌战略全新升级</p><p></p><h2>起底“数字化转型”，关键是如何构建“竞争力”的问题</h2><p></p><p></p><p>数字化转型不是一个新话题，甚至很多企业都已经做好了长期规划，并完成了核心系统的替换，比如金融行业的国产化已经推动了三批试点机构，涉及超过 150 家银行机构。这 150 家银行基本上涵盖了我国的大中型银行。换句话说，国内主要的银行都开始借助数字化转型的机遇同时推动国产化的工作。</p><p></p><p>网易数帆选择这个时间节点公布全新的品牌战略，显然不是单纯帮助企业来做数字化转型的。“目前发展不错的中大型企业基本已经开始了转型工作，先行者们抢占到了先机，然而企业会发现自己的竞争对手们跟得很紧，基本也都开始转型。此时，企业最需要关注的应该是‘如何构建自身竞争力’的问题”，汪源在采访中表示，就整个市场环境而言，存量市场基本占主导地位。即使是互联网这样曾几何时高速增长的行业，如今也进入了所谓的“下半场”，其增长已经相当有限，获取市场的主要手段往往是侵蚀竞争对手的份额。</p><p></p><p>在欧美等市场上，我们会发现行业的集中度非常高。比如，欧洲的汽车市场基本被奔驰、奥迪等巨头垄断。目前，国内许多行业的集中度还相对较低，头部企业的市场份额占比并不高。以中国的汽车行业为例，虽然市场总体规模不再增长，但其中的优秀企业仍有可能通过提升自身的竞争力来获取增量。在这个过程中，车企间的竞争将加剧，市场将进一步向头部企业集中。</p><p></p><p>存量市场的竞争将更加激烈，只有那些能够在存量市场中立足的企业，才有可能在未来的增量市场中占得先机。当前，寻找增量付出的成本可能比较高，因此，对于企业来讲“构建自身的竞争力”至关重要。</p><p></p><p>网易公司发展了 20 余年，从 2C 到 2B，沉淀了一套完整的方法论，网易数帆希望依托于此精耕数智，可以帮助企业在数字化转型的过程中构建自身的竞争力。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/b0/b0b905bae5d518bd7ece16b5c02f6575.png\" /></p><p></p><h2>铺天盖地“适合自身特点”的转型战略，到底什么是“适合”？</h2><p></p><p></p><p>当然，每个企业的转型过程都在寻求适合自己的战略，以构建自身的竞争力。所谓的“适合”需要结合企业的应用场景、发展阶段、市场规模、业务体量等诸多指标，市面上也有很多技术服务供应商号称可以解决“适合”的问题。那么，企业到底如何从初期就甄别出“适合”的战略呢？结合网易数帆的经验，汪源认为有一些共性的标准是企业可以参考的。</p><p></p><p>比如，数字化转型的投资收益率一定是核心因素。优秀的战略应该能够带来更高的投资回报率，但更重要的是它对效益的带动作用。从成本的角度来看，企业在实施数字化转型时，能否做到更轻量的成本投入也是非常重要的。在当前没有大的增量市场的情况下，企业对于投资的谨慎态度越来越明显，对投资的回报率和回收周期的要求也越来越高。</p><p></p><p>然而，企业要想实现满意的投资收益率，还需要解决很多问题。从产品的角度来看，市场上目前缺乏明确的、标准化的优秀产品的定义，许多提供商的产品质量和成熟度尚未达到非常优秀的水平。在产品选型上，整个行业也缺乏一个好的指导。许多企业在选择产品时，往往不能很好地评估不同提供商产品的能力，或者只关注产品的价格，这导致整个市场环境并不健康。</p><p></p><p>从人才方面来看，数字化人才招聘难度大，成本高。根据一些统计数据，中国大约有 600 万至 800 万软件开发者，但其中只有 10%~15% 是本科以下学历，其余 85%~90% 是本科及以上学历。这个人群的普遍薪资标准和劳动力成本明显高于其他人群。</p><p></p><p>此外，工程方面也缺乏相应的标准化。因软件工程比较灵活，所以业内并没有明确的标准流程和人才组合方式。虽然所谓的最佳实践有很多，但企业很难判断属于自己的最佳实践是什么。相比之下，其他行业，比如制造业和基建类的工程标准程度要高很多，这也是过去数十年积累的结果。</p><p></p><p>那么，企业如何解决上述问题呢？对此，网****易数帆以生产力三要素为核心，提出了数智生态方法论（PET）：产品 + 工程 + 人才。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/69/6915be2b6be52c392b535701c1a7cb7e.png\" /></p><p></p><h2>以人为本，解决企业数字化竞争力构建的“劳动力问题”</h2><p></p><p></p><p>首先，人才一定是最重要的。没有人的情况下，产品及工程标准再完美也无法实施。</p><p></p><p>当前，软件行业依旧存在巨大的人才缺口，且基层开发的人才需求量远大于管理层。软件行业典型的管理结构是：一名一线管理者（如组长或 Leader）平均能够管理 6-7 名开发人员，而 3-5 名这样的管理者上面会有一个经理，再上面是总监或架构师。也就是说，在软件行业的员工数量中，管理层（如 Leader、经理及以上）最多只占到 30% 左右，而绝大部分是一线开发者。我们知道，高素质的人才在职场上会有更好的发展机会，从事架构设计、管理等工作的更多是本科及以上学历的人才。然而，对于学历的统计，即便降到一线开发者层面，可能也只有 20%-30% 的人员是专科及以下学历。</p><p></p><p>换言之，尽管我国每年有 1000 万高等教育毕业生，然而其中 600 多万专科生基本上没有进入数字化和软件行业。但汪源认为，这实际上是可以突破的。通过一些技术创新让软件的开发门槛更低，增加专科学历专业人才的供给，这 600 万的劳动人才就可以进入到这个市场，从而有效地解决软件行业人才短缺的问题。</p><p></p><p>基于以上分析，网易数帆联合中国软件行业协会、百所高校共同发起了“百大高校人才联盟”。这是在“数字中国”战略背景下，为满足国家数字产业发展规划以及数字产业低代码相关行业配套人才培养需求的人才联盟。业界专家认为，应对数字技能人才供不应求，低代码软件开发已成为企业数智化的必经之路。然而，低代码平台能力和人才培养一直是限制其发展的两大问题，这正是网易数帆和该联盟发展的动力和契机。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/ed/edc136a1cdcecd96bb0fdb9dac48f4a7.png\" /></p><p></p><p>在低代码领域，网易数帆深耕多年，在网易内部也培养了很多低代码人才，覆盖集团 30 多个部门。那么，这些人才能够匹配行业行业缺口的需求吗？</p><p></p><p>汪源指出，网易数帆对低代码人才的培养主要面向专职开发人员，也兼顾业务人员。这是因为，业务人员能够进行的开发工作相对有限，主要涉及表单和审批流程等的设计。然而，业务人员无法胜任更复杂的、企业级的软件开发任务，例如企业 CRM 或 ERP 系统中的各种模块，这些涉及企业构建个性化核心竞争力的开发工作，必须由具备专业知识的专职开发人员来完成。</p><p></p><p>这一模式不仅在网易内部执行，网易数帆也为泰康人寿、三只松鼠等企业定向培养了数百名低代码人才。此外，网易数帆还通过覆盖全国 30 多个城市的产业基地，与多所高校建立了合作关系。合作初期，网易数帆主要鼓励学生们参加低代码大赛并学习 CodeWave 相关技术以获得认证，并为其提供就业机会。CodeWave 是网易数帆研发的低代码产品，其结合了 AIGC 功能，增强了平台能力并降低了人才培养成本，可以打通技术与业务的壁垒，使软件能够高效、灵活地支撑快速变化的业务需求。</p><p></p><p>这种合作模式为高校提供了更多机会，并进一步巩固了网易数帆与高校的关系。随着时间的推移，部分高校希望与网易数帆进行更深入的合作，引入相关课程，保证每年向社会输送一定数量的学生。据统计，目前已有 1000 多名从业者通过这一模式参与培训，累计低代码开发者认证人数已超过 3000。这，正是百大高校人才联盟的雏形。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/5c/5c12a8f50cdbb42d6dbb24c644d43f2b.png\" /></p><p></p><p>未来，百大高校人才联盟将基于网易数帆的 CodeWave 产品展开教学和训练，今年计划向生态、客户等输送 1000+ 开发者。未来五年，网易数帆希望能为社会培养出 100 万通过认证的工程师，并提供 10 万个坐席。</p><p></p><p>一个现实的问题是，环顾行业，虽然尚无其他企业或机构如网易数帆一般大张旗鼓投入低代码人才培养，但这一模式培养出来的人才，仍然需要具备足够的竞争力，才能成为突破软件行业人才供给、构建企业竞争力的新的解决方案。</p><p></p><p>汪源认为，虽然目前市面上也有很多低代码或者零代码的平台，但并不是每一个都值得专门学习，网易数帆之所以能够基于低代码平台构建起庞大的人才生态，主要得益于其自身的技术过硬。</p><p></p><p>相较于市面上盛行的其他平台，CodeWave 是包含编程语言和专业的开发框架等概念的，并不是只有图形化编程模式，只有具备这些能力，低代码平台才能不断突破复杂度的上限。这也是 CodeWave 值得被学习的原因，其是可以被用来开发企业核心关键应用，真正解决企业转型实际问题的平台，相关人才进驻企业是可以帮助企业解决问题的。据了解，云易星璨（重庆）文化传媒有限公司仅用时 9 天，便借助 CodeWave 智能开发平台搭建了一套固定资产管理系统，实现了各种业务效率提升翻倍的效果；重庆远致合创创新科技发展有限公司，仅用时 5 小时便完成了一套满足了企业比较特殊的“预约冲突处理”和“时间段选择”等企业特殊需求的会议室预约系统。</p><p></p><p>这，也是网易数帆数智生态方法论将产品和人才要素紧密结合的深层原因。</p><p></p><h2>产品是根基，网易数帆首创 CCDA 产品体系</h2><p></p><p></p><p>CodeWave 只是数智生态方法论中产品能力的一部分。汪源将产品比喻为根基，完整的根基是 CCDA 产品体系（Cloud Native、CodeWave、BigData、AI）， 指的是云原生、CodeWave、大数据和人工智能。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/1b/1b76820c0a492896237543b1a51295e0.png\" /></p><p></p><p>在企业的数字化进程中，大数据、云原生和 AI 这三大技术能力是最为普遍和需求最为广泛的。例如，企业在构建经营分析体系时会运用到大数据技术，而当企业需要快速迭代众多应用时，云原生技术便派上用场了。人工智能无疑是最为广泛和重要的领域之一，企业可以利用人工智能技术来提升软件开发效率与数据分析建设的质量，CodeWave 倡导的智能开发模式正是践行这一理念的重要载体。</p><p></p><p>人才到位了，产品能力也具备了。接下来，企业需要一套标准的工程方法论来通过技术构建产品。</p><p></p><h2>建立高效的软件工程服务方法</h2><p></p><p></p><p>网易在游戏、电商等领域的实践经验已经被网易数帆总结成了一套标准的工程方法论，并且网易数帆最近几年已经与相关机构合作，不断输出行业标准和工程实践方法论。未来，网易数帆将会拉动生态伙伴一起，通过共创的方式探讨、优化工程交付的全链路。汪源强调，只有生态伙伴参与工程实践标准建设，工程服务方法才具有生命力，能够在各行业落地生根。</p><p></p><p><img src=\"https://static001.geekbang.org/wechat/images/a3/a3527c8aa1f7bd08d11a3e3a275a03d2.png\" /></p><p></p><p>通过数智生态方法论，网易数帆致力于帮助企业构建更好的软件生态并持续输送人才到企业，以满足不断增长的业务需求和技术需求，从根本上解决企业数智竞争力构建的问题。</p><p></p><h2>以生态之力，筑数智未来</h2><p></p><p></p><p>在品牌全新启航之际，网易数帆也对未来做出了承诺。汪源表示，网易数帆未来重点将聚焦于完善产品、人才和工程方法，提升各项能力，使其更加成熟，包括构建和完善人才培养体系，以扩大人才库。接下来一年，网易数帆的核心目标是确保产品、人才和工程方法的有效落地，并至少与一部分核心合作伙伴共同实施这套方法。</p><p></p><p>从长远来看，网易数帆的愿景是将这一战略转化为大规模的实践，围绕生态伙伴形成一个大的生态圈，能够持续为其提供人才，或帮助他们具备自我培养的能力。同时，他们将始终作为核心能力的提供方，致力于打造更好的产品，完善人才培养体系，标准化工程方法，并与超过 1000 家的主要伙伴携手合作，以更好地满足客户的需求。</p><p></p><p>在中国，尽管软件厂商数量众多，但真正能够做好生态建设的厂商却屈指可数。网易数帆希望通过构建完善的生态系统来满足不断变化和增长的用户需求，这一举措不仅是对整个行业的重大突破，也将进一步推动数智中国的发展。以软件平台与数智服务为核心，帮助企业构建卓越的数智竞争力，凝聚力量，开启新的征程。</p>",
    "publish_time": "2023-11-10 15:47:20",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "通明智云技术副总裁冯勇，确认担任 QCon 面向人工智能时代的架构专题出品人",
    "url": "https://www.infoq.cn/article/ObPmthIHGJLL32ZqHftw",
    "summary": "<p><a href=\"https://qcon.infoq.cn/2023/shanghai/?utm_source=infoqweb&amp;utm_medium=teacherart&amp;utm_campaign=7&amp;utm_term=1110&amp;utm_content=fengyong\">QCon 全球软件开发大会</a>\"，将于 12 月在上海召开。通明智云技术副总裁冯勇将担任「<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1602?utm_source=infoqweb&amp;utm_medium=teacherart&amp;utm_campaign=7&amp;utm_term=1110&amp;utm_content=fengyong\">面向人工智能时代的架构</a>\"」的专题出品人。在此次专题中，从实践者角度出发的观点，你将了解到在以人工智能为中心的软件架构设计上奏效的方法，或者不奏效的方法。</p><p></p><p><a href=\"https://qcon.infoq.cn/2023/shanghai/track/1602?utm_source=infoqweb&amp;utm_medium=teacherart&amp;utm_campaign=7&amp;utm_term=1110&amp;utm_content=fengyong\">冯勇</a>\"，2001 年起加入 F5 公司，担任 F5 中国区构架师技术总监，帮助中国金融和运营商行业客户实现应用交付和安全构架，从传统数据中心进化到多云多活、云原生应用构架。通明湖产品构架、技术战略和大客户技术支持。</p><p></p><p>相信冯勇的到来，可以帮助提升此专题的质量，让你学习到构建人工智能系统和应用的现代软件架构的最新趋势和技术，能够帮助听众构建和维护未来基于人工智能的系统。</p><p></p><p>除上述专题外，QCon 上海还将围绕&nbsp;<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1598?utm_source=infoqweb&amp;utm_medium=teacherart\">智能化信创软件&nbsp;IDE</a>\"、<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1595?utm_source=infoqweb&amp;utm_medium=teacherart\">GenAI和通用大模型应用探索</a>\"、<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1597?utm_source=infoqweb&amp;utm_medium=teacherart\">LLM&nbsp;时代的性能优化</a>\"、<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1599?utm_source=infoqweb&amp;utm_medium=teacherart\">LLM&nbsp;时代的大前端技术</a>\"、<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1602?utm_source=infoqweb&amp;utm_medium=teacherart\">面向人工智能时代的架构</a>\"、<a href=\"https://qcon.infoq.cn/2023/shanghai/track/1604?utm_source=infoqweb&amp;utm_medium=teacherart\">性能工程：提升效率和创新的新方法</a>\"等专题进行交流。</p><p></p><p>QCon 上海 2023，相约 12 月！现在购票，享 7 折优惠，立减￥2040！咨询购票请联系：18514549229（微信同手机号）。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/01/0113b3dfb187d5f9988b7eb16d2e0594.png\" /></p><p></p>",
    "publish_time": "2023-11-10 16:30:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "首期AI+软件工程主题沙龙重磅来袭",
    "url": "https://www.infoq.cn/article/LpG78ukiCqjpi0bpwltt",
    "summary": "<p>为探讨人工智能时代AI如何深度融合软件工程领域，洞察未来软件开发新趋势，由中国信息通信研究院、中国软件行业协会、应用现代化产业联盟联合主办的首期“&nbsp;Al+ 软件工程主题沙龙”将于11月 21日在京召开。</p><p></p><h2>会议时间</h2><p></p><p>2023年11月21日14:00-17:30</p><p></p><h2>会议地点</h2><p></p><p>北京（丽亭华苑酒店）</p><p></p><h2>会议联系人</h2><p></p><p>中国信通院人工智能创新中心</p><p>胡老师17371328072（微信同号） huhui@caict.ac.cn</p><p>秦老师13488684897（微信同号） qinsisi@caict.ac.cn</p><p></p><h2>会议议程</h2><p></p><p></p><p><img src=\"https://static001.infoq.cn/resource/image/15/03/1536f924a258930c635143496eed9603.jpeg\" /></p><p></p>",
    "publish_time": "2023-11-10 17:37:56",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "高吞吐低延迟：朴朴基于 Kafka 的延迟队列实践",
    "url": "https://www.infoq.cn/article/2YMOLi5o2ooj1vW3R3q7",
    "summary": "<p>延迟队列，简单来说就是在普通队列之上增加延迟的属性，使得消息在指定的延迟时间后被投递到目标队列。其适用场景如下：</p><p></p><p>超时处理：订单支付超时关闭，在下单时投递一条延迟消息，并在指定时间后消费消息并关闭订单；异常重试：业务处理逻辑出现异常，需要在一段时间后进行重试，可投递一条包含重试内容的延迟消息。</p><p></p><p>在未实现 Kafka 延迟队列之前，公司内部实现延迟队列的方式不一，其实现方式主要有以下几种：</p><p></p><p>定时任务扫表，每分钟扫表一次，查询一小时内超过 10 分钟未支付的订单；RabbitMQ 自带的延迟消息特性；基于 Redis 的 zset 实现延迟消息。</p><p></p><p>但随着业务的快速增长，以上方式逐渐暴露出了不同问题：</p><p></p><p>定时任务扫表：延迟时间长，有接近 1 分钟的延迟，而且频繁扫表增加数据库压力；RabbitMQ 自带的延迟消息：在日益增长的业务背景下，RabbitMQ 的吞吐量劣势愈发明显，无法满足业务需求；基于 Redis 实现的延迟消息：消息未经持久化，不支持消息回溯，且存在丢失风险，对于可靠性要求较高的业务不适用。</p><p>&nbsp;</p><p>基于以上问题，也出于技术架构的统一，我们决定调研或自研一款通用的高吞吐、低延迟的延迟队列，来满足业务不同场景的需求。</p><p></p><h1>解决思路</h1><p></p><p></p><p>当前比较常规的低延迟的延迟队列实现主要有两种：通过 消息队列（MQ） 实现 以及 通过 Redis 来实现。由于 Redis 的持久化机制导致其对消息的可靠性无法保证，不予考虑，因此主要考虑使用 MQ 来实现延迟队列。常用的几款 MQ 的对比如表 2-1 所示：</p><p></p><p>表 2-1 消息中间件对比</p><p>&nbsp;</p><p>在前文已经提到，由于 RabbitMQ 的吞吐量太低，无法满足日益增长的业务需求，所以不予考虑。从表 2-1 可以看出，RocketMQ 和 Kafka 的吞吐和消息延迟都很低，而且 RocketMQ 还已经支持延迟队列，最高版本还支持任意延迟等级的延迟队列，能够满足业务高吞吐、低延迟的要求，理应是最佳选择。但最新版本的 RocketMQ 如果选择支持任意延迟等级的功能，其吞吐量会相较于之前下降一倍以上，另外目前公司内部未使用 RocketMQ，引入新的中间件会引入额外的风险以及增加运维成本，所以这个选项也先被搁置。</p><p>&nbsp;</p><p>目前公司内部主要用的消息队列是 Kafka，Kafka 在吞吐和延迟上能够满足业务对延迟队列的需求，但是它不支持延迟队列，因此我们考虑是否可以基于 Kafka 来自研一套延迟队列。基于 Kafka 实现延迟队列虽然要自己实现延迟消息的管理与投递，但它的优势有：</p><p>&nbsp;</p><p>(1)&nbsp;延迟队列服务可以独立于 Kafka broker，对 broker 不会引入额外的压力；</p><p>(2)&nbsp;延迟队列服务是可以横向扩容的，理论上可以支持任意级别的延迟时间，而且还能保持高吞吐特性；</p><p>(3)&nbsp;基于 Kafka 实现延迟队列，无需引入新的中间件，无额外的运维压力；</p><p>(4)&nbsp;自研的延迟队列更易于维护和更新迭代。</p><p>&nbsp;</p><p>基于以上考虑，我们决定基于 Kafka 自行实现一套延迟队列。</p><p></p><h1>实现方案</h1><p></p><p></p><h2>核心原理</h2><p></p><p>延迟队列的核心实现原理如图 3-1 所示，其原理与RabbitMQ以及 RocketMQ 旧版实现相似，都是针对不同的延迟等级创建队列，增设调度服务用于定时消费带有延迟属性的队列，并将消费到的数据投递到目标队列。这里每个队列都是对应一个个 Kafka topic，业务服务将消息投递到对应的队列中（也就是不同延迟等级对应的 topic 上），由延迟调度服务将各个队列中的数据准时地投递到业务实际目标的 topic 中，之后业务服务再消费目标 topic 中的数据进行下一步处理。</p><p><img src=\"https://static001.geekbang.org/infoq/ea/ea53c31cefca6f7d24fcf14e19437c62.png\" /></p><p>图 3-1 延迟队列实现原理</p><p></p><h2>整体架构</h2><p></p><p></p><p>延迟队列实现的整体架构图如图 3-2 所示。其中核心部分主要有 3 个模块：Manager 服务、延迟调度服务 以及 SDK（延迟队列客户端）。它们的各自负责的功能介绍如下：</p><p>&nbsp;</p><p>Manager 服务</p><p>&nbsp;</p><p>延迟队列的管理平台，负责对整个延迟队列进行监控和管理，如业务接入、队列健康情况监控等等。</p><p></p><p>延迟调度服务</p><p>&nbsp;</p><p>延迟调度服务是延迟队列实现的核心，负责将延迟等级队列中的数据准时地转发至业务实际 topic 中。为了让业务之间不互相影响，在队列之上引入了分组的概念，每个业务域可以独立配置一个组，组与组之间的延迟队列是相互独立的。延迟队列的每个延迟等级都与 Kafka 的 topic 相对应，是 1:N 的关系，确保每个延迟等级的吞吐可以无限扩展。延迟调度服务在运行过程中会上报关键指标（转发延时、各节点处理耗时等），助于问题排查和稳定性监控。</p><p>&nbsp;</p><p>SDK（延迟队列客户端）</p><p>&nbsp;</p><p>延迟队列客户端是用于协助业务将需要延迟处理的数据写入到延迟队列中，这里将延迟队列客户端封装为 SDK，方便业务接入。</p><p><img src=\"https://static001.geekbang.org/infoq/55/55ca9728a097af2c8dc779053c61e2e5.png\" /></p><p>图3-2 整体架构图</p><p></p><h2>核心设计点</h2><p></p><p></p><h3>消息高效转发与低延迟</h3><p></p><p></p><p>延迟队列实现的核心点是要将业务写入到不同延迟等级的队列中的数据准时地投递到目标 topic。这里「准时」的定义是在消息延迟时间未到时不能进行消息投递，当延迟时间到达时，要快速将数据投递到目标 topic，从而降低延迟时间。</p><p>&nbsp;</p><p>最初我们实现数据转发的方案是通过 KafkaConsumer 的 pause、resume 来对分区消费的暂停、恢复。kafka-clients 提供了两个 API：KafkaConsumer#pause、KafkaConsumer#resume，通过这两个 api 能够对未到达消息发送的分区进行暂停，并在发送时刻唤醒转发。后来经过测试发现，进行 pause 后 resume 的分区并不能及时消费到消息，而是在 resume 后的 100～500ms 才能获取到消息，这大大增加了延时时间，不满足「低延迟」的要求。</p><p>&nbsp;</p><p>通过对 Kafka-clients 的源码和版本分析发现：在kafka-clients 2.3及以下版本中，对分区进行 pause 后，本地缓冲区中的分区消息失效，再进行 resume时，需要等待缓冲区消息消费完成后重新 fetch 消息，增加了网络消耗，耗时远大于本地内存处理。在kafka-clients 2.4 及以上版本中，调整了这部分逻辑，pause 的分区在过滤后重新放回本地缓冲区，在未触发重平衡的情况下，resume 后仍可以从内存中消费。图 3-3 列出了 kafka-clients 2.3.1 版本和 2.4.0 版本代码的差异（其中左图为 2.3.1 版本，右图为 2.4.0 版本）。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/a1/a11c78201d62cb676a8cc7d825354961.jpeg\" /></p><p>图 3-3 kafka-clients 差异代码对比</p><p>&nbsp;</p><p>发现问题后，我们采用了另一种方式：线程内休眠等待。这种实现方式有两个注意点：</p><p>&nbsp;</p><p>休眠时间的长短设置。休眠时间过长，会导致延迟上升。休眠时长过短，会导致频繁无效拉取，导致资源浪费；消息投递的准确性。正常情况下一个消费组会消费同一个队列的多个分片，这里如果消费线程出现休眠等待，会导致所有分片的数据无法被投递。</p><p>&nbsp;</p><p>针对休眠时间的问题，为了能够降低延迟时间，我们采用根据最近一条待投递的消息的投递时间距离当前时间的长短来确定休眠时间。另外为了避免过长的休眠时间导致消费组发生重平衡，所以也加入了固定时长休眠机制。通过这两种机制结合确保低延迟，同时也不会造成重平衡。</p><p>&nbsp;</p><p>针对消息投递准确性问题的实现方案是让每个 topic 都只有一个分片，每个 topic 对应一个消费组。这样如果第一条数据都不需要被投递，那么这个队列就没有消息需要被投递，也不存在该被投递的消息因为休眠而无法被准时投递出去的问题。另外在配置关系上将延迟队列等级与 topic 的对应关系改为 1:N，可以解决由于每个 topic 只有一个分片而引起的写入性能瓶颈。这样做的好处不仅仅是确保了消息的准确投递，理论上通过增加延迟调度服务和扩展队列对应的 topic，能够让延迟队列支持任意时间的延迟等级，以及支持每个延迟等级的吞吐无上限。</p><p></p><h3>支持消费任务的负载均衡</h3><p></p><p></p><p>上文提到可以通过增加延迟调度服务的实力以及扩展延迟队列对应的 topic 将对应的延迟级别以及吞吐提升上去。但当延迟调度服务的实例和 topic 数增加到一定程度后就会出现一个问题，就是各个延迟调度服务分配到的 topic 会出现不均衡的情况，如图 3-4 所示。这样会导致即使增加延迟调度服务的实例，整个系统也会出现性能瓶颈。</p><p><img src=\"https://static001.geekbang.org/infoq/a2/a2fbde6fd118d84ee3b7351793363870.png\" /></p><p>&nbsp;图 3-4 topic 分配不均</p><p></p><p>因此需要由一个支持消费任务负载均衡的方案，将多个 topic 的消费任务均匀地分配给各个延迟调度服务实例中，确保各个延迟调度服务之间压力近似。具体方案的实现逻辑如图 3-5 所示：</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/75/753f33aef1850c38e83496ccd10c3183.png\" /></p><p>图 3-5 负载均衡实现逻辑</p><p></p><p>流程说明：</p><p></p><p>延迟调度服务实例启动后，需要向 ZK 注册临时节点；延迟分配策略由其中一个延迟调度实例完成，各个延迟调度服务实例通过抢占锁的方式来确定由谁执行；负责执行调度策略的实例根据当前需要消费的总 topic 数以及延迟调度实例数，在结合队列类型，将 topic 分配给各个实例，并将结果写入 zk 中；各延迟调度服务实例监听到分配结果变更后就会将结果拉取下来，并启动对应的消费组消费对应 topic 的消息；当有新的延迟调度实例加入或者老的宕机后，会重新开启新的一轮分配。新的分配逻辑与之前近似，只是会结合当前已有分配情况进行重新调整，避免大面积的消费组重启。</p><p></p><h3>消息可靠性的保证</h3><p></p><p></p><p>作为一款通用的延迟队列，我们需要提供消息可靠性的保障，确保数据不丢失。为此，基于 Kafka 特性，延迟队列对外提供两种语义的配置：</p><p>&nbsp;</p><p>至少一次：确保消息不丢且保证有序，但有可能重复投递；有且仅有一次：确保消息不丢且不重复投递，并保证有序。这种方案在吞吐上有较多的损耗，且该语义是基于 Kafka 事务机制来实现，包含了 Kafka 事务缺陷。</p><p>&nbsp;</p><p>除此之外，为了保证数据不丢失，还对于延迟调度服务进行了以下优化：</p><p>&nbsp;</p><p>生产者 acks 设置为 all ；消费具有延迟属性的延迟消息，offset 在消息成功转发回调中处理提交。这样即使在断电等极端情况下，仍能在系统恢复后继续从上次成功发送的记录后开始消费；当出现异常时，回退 offset 并等待后重试。打印日志，触发告警，人为介入。若为网络原因，则自行恢复；优雅关闭，关闭前处理完当前内存中的消息再关闭。</p><p></p><h1>线上实践效果</h1><p></p><p></p><p>(1)&nbsp;单队列可支撑的吞吐量</p><p>&nbsp;</p><p>目前单队列（队列对应的是一个单分片的 topic）在延迟转发服务实例配置为 2 核 4G 的情况下进行压测，结果如表 4-1 所示（数据仅供参考，未进行参数调优）：</p><p></p><p>表 4-1 吞吐量压测结果</p><p></p><p>(2)&nbsp;目前业务接入量</p><p></p><p>目前该延迟队列服务上线稳定运行接近 5 个月，有近 40 个服务正在使用，已配置 16 个延迟时间（可动态增加），如图 4-2 所示：</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/a3/a3df5362e19f459ec6fb40a32583c938.png\" /></p><p>&nbsp;图 4-2 业务接入情况</p><p></p><p>(3)&nbsp;毫秒级别的转发延时</p><p>&nbsp;</p><p>这里转发延时表示队列中的消息应当被投递的时间与真实被投递的时间之间的差异。目前通过监控可以看到，各个队列里消息的转发投递延迟都在 1 ms 以内，如图 4-3 所示。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/38/38e6f8828e644cce957049f41d3276c2.png\" /></p><p></p><p>图 4-3 消息延迟指标</p><p></p><h1>展望</h1><p></p><p></p><p>目前延迟队列已在线上稳定运行了一段时间，一些基本功能特性都已经具备并能稳定提供服务。但当前我们实现的延迟队列包括目前市面上较多的延迟队列都使用“给单个队列赋予固定延迟时间”的方案，这种方式的缺点是想要支持任意延迟等级的延迟队列需要不停地创建 topic 去支持，最终会导致 topic 无限膨胀。</p><p>&nbsp;</p><p>在日益复杂的业务背景下，任意延迟等级的队列也会被提上议程。因此后续我们将优化任意延迟等级的特性的实现。此外我们还会在易用性以及高可用性上进行相应建设，并不断丰富产品特性，为业务稳定发展提供有力支持。</p>",
    "publish_time": "2023-11-10 17:38:14",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  }
]