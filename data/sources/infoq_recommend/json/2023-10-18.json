[
  {
    "title": "每日24亿事件处理：Airbnb的Riverbed技术解析",
    "url": "https://www.infoq.cn/article/BAFdDgo3MvJXau26mURs",
    "summary": "<p>Airbnb<a href=\"https://medium.com/airbnb-engineering/riverbed-optimizing-data-access-at-airbnbs-scale-c37ecf6456d9?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">开发的Riverbed是一个Lambda风格的数据框架</a>\"，用于生成和管理分布式物化视图。该框架支持50多个涉及重度数据读取的应用场景，在这些场景中，数据来自Airbnb面向服务架构(SOA)平台的多个数据源。它分别使用Apache Kafka和Apache Spark作为在线和离线处理组件。</p><p></p><p>Airbnb观察发现，一些跨多个不同数据存储的复杂查询是导致该平台主要功能出现延迟的罪魁祸首。开发团队不能使用数据库提供的标准的物化视图，因为计算物化视图所需的数据不在单个数据库中。</p><p></p><p>开发团队尝试使用一种技术来创建分布式物化视图，该技术使用了<a href=\"https://en.wikipedia.org/wiki/Change_data_capture?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">变更数据捕获(CDC)</a>\"、流处理和专门用来存储最终结果的数据库。他们仔细权衡了数据处理架构：</p><p></p><p></p><blockquote>Lambda和Kappa是两种实时数据处理架构。Lambda结合了批处理和实时处理，可以有效地处理大数据量，而Kappa仅专注于流处理。Kappa的简单性提供了更好的可维护性，但在实现回填机制和确保数据一致性方面存在挑战，特别是对于乱序事件。</blockquote><p></p><p></p><p>Riverbed框架采用了Lambda架构，并提供了一种声明式的方式，使用<a href=\"https://graphql.org/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">GraphQL</a>\"为在线(实时事件)和离线(数据回填)组件定义数据查询和计算逻辑。该框架负责并发、版本控制和数据正确性保证，以及与基础设施组件的集成。</p><p></p><p></p><p><img src=\"https://static001.geekbang.org/infoq/67/67de98fae92e9d47e49582679bc2bf5a.webp\" /></p><p></p><p>Riverbed的流式处理(来源：<a href=\"https://medium.com/airbnb-engineering/riverbed-optimizing-data-access-at-airbnbs-scale-c37ecf6456d9?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">Airbnb工程博客</a>\")</p><p></p><p>对于实时处理，Riverbed使用<a href=\"https://kafka.apache.org/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">Apache Kafka</a>\"消费数据源发出的变更数据捕获(CDC)事件来进行消息传递。来自CDC的事件通过执行用GraphQL定义的聚合逻辑来更新物化视图，结果文档存储在物化视图数据库中。为了提高效率，处理是高度并行化和批量化的。</p><p></p><p>流式管道避免了竞态条件，因为CDC事件在Apache Kafka中基于物化视图文档的标识符被重新分区，因此对物化视图的更新是顺序完成的。此外，在在线(实时)和离线(批处理)处理之间使用<a href=\"https://en.wikipedia.org/wiki/Optimistic_concurrency_control?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">乐观并发控制</a>\"来避免并发写和潜在的数据不一致。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/3d/3d357ce78cf5a04a9b086e7e0be8d00a.webp\" /></p><p></p><p>Riverbed的批处理(来源：<a href=\"https://medium.com/airbnb-engineering/riverbed-optimizing-data-access-at-airbnbs-scale-c37ecf6456d9?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">Airbnb工程博客</a>\")</p><p></p><p>Riverbed支持数据回填和协调，以防出现因丢失CDC事件导致的实时处理问题。这一部分使用<a href=\"https://spark.apache.org/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">Apache Spark</a>\"来处理存储每日快照的数据仓库中的数据。该框架基于在Riverbed中配置的GraphQL定义生成<a href=\"https://spark.apache.org/sql/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTc0MjIyNjIsImZpbGVHVUlEIjoibG9xZU1wOE55TUM0ODJxbiIsImlhdCI6MTY5NzQyMTk2MiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo2MjMyOH0.IhskYNPEbAyCQZqGb3pvdnAXhoTNzCRd5Hg1e-O0mJw\">Spark SQL</a>\"。</p><p></p><p>Riverbed目前每天处理24亿个事件，写入3.5亿个文档，处理与Airbnb的支付、搜索、评论、行程和内部产品等功能相关的50多个物化视图。</p><p></p><p></p><p>原文链接：</p><p><a href=\"https://www.infoq.com/news/2023/10/airbnb-riverbed-introduction/\">https://www.infoq.com/news/2023/10/airbnb-riverbed-introduction/</a>\"</p>",
    "publish_time": "2023-10-18 08:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  },
  {
    "title": "突发！美国限制向中国出口Nvidia H800等先进AI芯片，壁仞科技、摩尔线程等中国GPU芯片企业被列入实体名单",
    "url": "https://www.infoq.cn/article/QJ73po4wuwTvLKcpK1Fw",
    "summary": "<p></p><blockquote>据悉，美国这一新规将在向公众征求 30 天意见后生效。</blockquote><p></p><p></p><h2>美国升级对华芯片出口限制</h2><p></p><p></p><p>据路透社报道，美国商务部 10 月 17 日宣布，计划限制向中国出售更先进的 AI 芯片。据悉，新的政策将限制 Nvidia A800 和 H800 芯片的出口，此外，新规将豁免笔记本电脑、智能手机和游戏设备中使用的大多数消费级芯片，但其中部分芯片仍须受到美国官员的批准和专项管控。相关规定将在未来 30 天内生效。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/d7/d7882b8c99a56d822db36ce76f2b1052.png\" /></p><p></p><p>10 月 16 日晚，美国商务部长 Gina Raimondo 曾对记者表示，新措施弥补了去年 10 月所发布法规中的漏洞，未来可能“至少每年更新一次”。她解释称，此番措施的目标是限制中国获取“先进半导体，这些半导体能够推动 AI 技术发展以及对军事应用具有重大意义的复杂计算机突破”，并强调美国政府无意在经济上打压中方。她表示，中国仍可进口价值数千亿美元的美国半导体。</p><p>&nbsp;</p><p>2022 年 10 月 7 日，美国政府以出台“临时规则”形式更新《出口管理条例》，将 31 家中国实体列入“未经核实清单”，并升级对华半导体出口管制，以&nbsp;Nvidia&nbsp;A100 芯片的性能指标作为限制标准，限制对华出口高性能计算芯片。具体来说，同时满足以下两个条件的即为受管制的高性能计算芯片：</p><p>&nbsp;</p><p>芯片的 I/O 带宽传输速率大于或等于 600 Gbyte/s；“数字处理单元 原始计算单元”每次操作的比特长度乘以 TOPS 计算出的算力之和大于或等于 4800TOPS。</p><p>&nbsp;</p><p>彼时受该政策影响，Nvidia&nbsp;A100 及 H100 GPU 加速芯片都无法继续对华出口。随后，Nvidia 针对中国大陆市场推出特供版的 A800 及 H800 芯片——仅保留了强大的计算能力，但对通信速度做出了限制以保证符合此前规定要求。自去年的规定实施以来，Nvidia&nbsp;面向中国的专供芯片需求大增、带动业务一路高歌猛进。受全球供应不足影响，获准销售的几乎一切&nbsp;Nvidia 芯片都在中国大受欢迎。</p><p>&nbsp;</p><p>如今美国加码芯片出口限制，新规则对特定尺寸芯片的计算能力也做出了限制，旨在防止使用新的“Chiplet”技术方法绕开限制。因此，Nvidia A800 和 H800 芯片对华出口也将受到影响。</p><p>&nbsp;</p><p>对此，Nvidia 表示，该公司将遵守规定、且预计近期业绩不会因此受到重大影响。但截至 10 月 17 日美股收盘，Nvidia 股价下跌 4.68%，同样受到新规则影响的 AMD、Intel 等相关企业股价也有相应下滑。</p><p>&nbsp;</p><p>除了升级对华芯片出口限制，此次美国新规还扩大了面向另外 40 多个国家出口先进芯片的管控要求。据路透社报道，这项措施似乎基于英伟达在今年 8 月收到的一封信函。信中称本应受到供应限制的 A100 和 H100 芯片从中国流出至包括中东在内的其他国家。此前路透社报道的猜测也在新规则中得到证实，即对于母公司总部位于中国、澳门及其他部分国家的企业，不得将芯片移交给位于世界任何地方的下辖子公司。</p><p>&nbsp;</p><p>美国还对中国以外的 21 个国家提出了芯片制造工具出口管控要求，原因是担心这些设备可能被转移给中国或其他国家，进而引发安全问题。</p><p>&nbsp;</p><p>此外，新规还在对中出口限制清单中添加了 DUV 光刻系统，相当于对政策做出进一步收紧。此前，美国曾禁止荷兰 ASML 向部分中国先进芯片工厂提供较旧型号的深紫外光刻设备及备件。DUV 设备属于尖端 EUV 设备（目前对中国全面禁售）的前代设备，但同样属于先进的芯片制造工具，能够以更高的成本制造出几乎同等制程的芯片。</p><p>&nbsp;</p><p>ASML 在一份声明中表示，新规可能在中长期内对“我方系统在特定区域内的销售”产生影响，但该公司预计 2023 年内的财务前景应该不会受到“实质性冲击”。</p><p></p><h2>多家中国GPU芯片企业被列入实体名单</h2><p></p><p>&nbsp;</p><p>此外，美国商务部在 10 月 17 日还将壁仞科技、摩尔线程等多家中国 GPU 芯片企业列入实体名单。</p><p>&nbsp;</p><p>具体包括：北京壁仞科技开发有限公司、广州壁仞集成电路有限公司、杭州壁仞科技开发有限公司、光线云（杭州）科技有限公司、摩尔线程智能科技（北京）有限责任公司、摩尔线程智能科技（成都）有限责任公司、摩尔线程智能科技（上海）有限责任公司、上海壁仞信息科技有限公司、上海壁仞集成电路有限公司、上海壁仞科技股份有限公司、超燃半导体（南京）有限公司、苏州芯延半导体科技有限公司、珠海壁仞集成电路有限公司。</p><p></p><p><img src=\"https://static001.geekbang.org/infoq/da/da05d4dfac3c9968b1dbe0798fde537b.png\" /></p><p></p><p>对此，壁仞科技在 10 月 17 日晚间发表声明称，公司对美国商务部此举表示强烈反对，将向美方有关政府部门积极申诉，并呼吁美国政府重新进行审视。壁仞科技以“智绘全球”为愿景，严格遵守相关国家和地区的法律、法规，并在此基础上始终合法依规经营。公司正在评估此事件可能对公司造成的影响，做好应对工作，并将与各方面积极沟通。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/41/41da8578559838606c2128232bf41056.png\" /></p><p></p><p>摩尔线程也在声明中表示强烈抗议：摩尔线程自成立以来，严格遵守相关国家和地区的法律、法规，始终秉持合法、合规的企业文化和管理理念，建立了完善的出口管制合规管理体系和工作流程指引。目前公司正在与各方积极沟通，对于该事项的影响我们正在评估。</p><p>&nbsp;</p><p><img src=\"https://static001.geekbang.org/infoq/4f/4f32d3cdef00b714876c3d202f225e49.png\" /></p><p></p><h2>ASML CEO：孤立中国没有希望，实际上会削弱西方自己</h2><p></p><p>&nbsp;</p><p>事实上，围绕美国出口限制政策一直存在不少反对的声音。</p><p>&nbsp;</p><p>据彭博社报道，Nvidia、Intel 和高通这三大美国本土芯片巨头的首席执行官一直在警告美国政府不要对华采取高压手段。在减少中国获得高尖端技术的同时，他们担心对向中国出口非尖端芯片的新限制将剥夺他们的大量收入来源。美国商会估计，如果出现最糟糕的情况，即对中国的销售完全停止，美国芯片公司每年可能会损失 830 亿美元、12.4 万个工作岗位，相关研发支出每年将减少 120 亿美元。</p><p>&nbsp;</p><p>ASML 现任总裁兼首席执行官 Peter Wennink 也曾在当地电视节目 Nieuwsuur 上说道，“完全孤立中国是没有希望的。如果我们不分享技术，他们就会自己去研究。”Peter Wennink 认为通过禁止技术移民和出口管制等方式孤立中国，实际上会削弱西方自己。</p><p>&nbsp;</p><p>此外，据环球网报道，香港半导体行业分析师林子恒 16 日对《环球时报》记者分析称，拜登政府在芯片领域的限制行动意图明显，就是想“扼杀”中国芯片产业，削弱中国在未来全球高科技领域竞争中的实力，并维护自身的科技霸权。林子恒认为，媒体报道的新限制措施更有针对性，可能会为中国芯片行业以及人工智能行业的发展带来新挑战，但也会激发出中国科研机构和企业的攻关动力。</p><p>&nbsp;</p><p>参考链接：</p><p><a href=\"https://www.reuters.com/technology/biden-cut-china-off-more-nvidia-chips-expand-curbs-more-countries-2023-10-17/\">https://www.reuters.com/technology/biden-cut-china-off-more-nvidia-chips-expand-curbs-more-countries-2023-10-17/</a>\"</p><p><a href=\"https://www.bis.doc.gov/index.php/about-bis/newsroom/2082\">https://www.bis.doc.gov/index.php/about-bis/newsroom/2082</a>\"</p><p><a href=\"https://baijiahao.baidu.com/s?id=1779952136508708360&amp;wfr=spider&amp;for=pc\">https://baijiahao.baidu.com/s?id=1779952136508708360&amp;wfr=spider&amp;for=pc</a>\"</p>",
    "publish_time": "2023-10-18 12:04:23",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  }
]