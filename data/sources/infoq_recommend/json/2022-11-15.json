[
  {
    "title": "CDKTF通过增加命名空间来提升性能",
    "url": "https://www.infoq.cn/article/hOKj25tXc7DuTt9ujN5w",
    "summary": "<p><a href=\"https://www.infoq.com/hashicorp/\">HashiCorp</a>\"发布了<a href=\"https://github.com/hashicorp/terraform-cdk/\">CDK for Terraform</a>\"（CDKTF）<a href=\"https://www.hashicorp.com/blog/cdk-for-terraform-0-13-significantly-improves-performance\">0.13版本</a>\"，在性能上有了显著的改进。这个版本引入了命名空间，极大提升了基础设施的性能。这个版本基于0.12版本，而0.12版本见证了CDKTF的<a href=\"https://www.hashicorp.com/blog/cdk-for-terraform-now-generally-available\">普遍可用</a>\"。</p><p></p><p>CDK允许用户使用多种编程语言编写Terraform配置，包括C#、Python、TypeScript、Go语言和Java。它支持现有所有的Terraform<a href=\"https://www.terraform.io/docs/providers/index.html\">提供程序</a>\"和<a href=\"https://www.terraform.io/docs/modules/index.html\">模块</a>\"。CDKTF应用程序代码生成JSON输出，可以直接使用Terraform部署。</p><p></p><p>0.13版本为生成的提供程序绑定中的每个类引入了命名空间的概念。这些命名空间是自动从Terraform资源或数据来源派生出来的。以前，每个提供程序的导出结果都是扁平的组件列表，其结果是各种语言编译器难以处理这些很大的包。CDKTF的用户表示，处理过程可能非常慢，对于Python用户来说，可能会导致IDE发生崩溃。</p><p></p><p>有了命名空间，就会生成许多小的包，这样编译器处理起来会更快。根据Hashicorp工程经理<a href=\"https://www.linkedin.com/in/narakasbergen/\">Nara Kasbergen Kwon</a>\"的说法，这已经带来了处理时间上的一些显著改善。Kwon表示，最近的基准测试显示：</p><p></p><p></p><blockquote>在使用Go语言和Azure提供程序时，cdktf处理时间减少了96.8%；在使用Java和谷歌云提供程序时，cdktf处理时间减少了83%；在使用C#和AWS提供程序时，cdktf处理时间减少了36.8%；在使用TypeScript和Kubernetes提供程序时，cdktf处理时间减少了61.5%。命名空间的引入是一个突破性的变化，不过0.13版本也向后兼容0.12版本生成的提供程序绑定。这样可以根据需要混合使用命名空间和非命名空间提供程序。注意，0.13版本生成的提供程序将包含命名空间。这种向后兼容性将在0.14版本中被删除，届时将只支持命名空间提供程序。</blockquote><p></p><p></p><p>AWS提供程序以前是有命名空间的，只是实现方式不同于新的命名空间。因此，它的导入方式已更改为与新的命名空间模型保持一致。以前，AWS提供程序可以按如下方式导入（Go语言）：</p><p></p><p><code lang=\"java\">import (\n // ... 其他导入\n \"github.com/cdktf/cdktf-provider-aws-go/aws\"\n)\n\nfunc NewMyStack(/* ... */) cdktf.TerraformStack {\n stack := cdktf.NewTerraformStack(/* ... */)\n\n aws.NewAwsProvider(/* ... */)\n aws.NewCloudfrontDistribution(/* ... */)\n aws.NewAcmCertificate(/* ... */)\n}\n</code></p><p></p><p>在新的命名空间模型中，现在需要按以下方式导入：</p><p></p><p><code lang=\"java\">import (\n // ... 其他导入\n \"github.com/cdktf/cdktf-provider-aws-go/aws/cloudfrontdistribution\"\n \"github.com/cdktf/cdktf-provider-aws-go/aws/provider\"\n \"github.com/cdktf/cdktf-provider-aws-go/aws/acmcertificate\"\n)\n\nfunc NewMyStack(/* ... */) cdktf.TerraformStack {\n stack := cdktf.NewTerraformStack(/* ... */)\n\n provider.NewAwsProvider(/* ... */)\n cloudfrontdistribution.NewCloudfrontDistribution(/* ... */)\n acmcertificate.NewAcmCertificate(/* ... */)\n}\n</code></p><p></p><p>据Kwon透露，0.14版本将于2022年11月中旬发布。Kwon表示，这一版本“将主要关注易用性的改善，让使用<a href=\"https://www.terraform.io/cdktf/concepts/providers#install-pre-built-providers\">预构建提供程序</a>\"变得更容易。”开发团队发现，与在本地使用cdktf get在生成提供程序相比，预构建提供程序提供了更好的开发者体验。</p><p></p><p>关于这个版本更多的信息可以在<a href=\"https://www.hashicorp.com/blog/cdk-for-terraform-0-13-significantly-improves-performance\">博文</a>\"和<a href=\"https://www.terraform.io/cdktf/release/upgrade-guide-v0-13?_gl=1*1unzpu4*_ga*MjExNzMxNzQyMy4xNjYzODk4MDA0*_ga_P7S46ZYEKW*MTY2NjIxMDEwMC4yMy4xLjE2NjYyMTA0OTMuMC4wLjA.\">升级指南</a>\"中找到。Hashicorp主持<a href=\"https://www.hashicorp.com/community/office-hours\">Community Office Hours</a>\"，并提供了一个讨论问题的<a href=\"https://discuss.hashicorp.com/c/terraform-core/cdk-for-terraform/47\">论坛</a>\"。对于刚接触CDK的用户，可以参考<a href=\"https://learn.hashicorp.com/collections/terraform/cdktf\">CDK for Terraform学习指南</a>\"。</p><p></p><p>原文链接：</p><p><a href=\"https://www.infoq.com/news/2022/10/cdk-terraform-performance/\">https://www.infoq.com/news/2022/10/cdk-terraform-performance/</a>\"</p><p></p><p>相关阅读：</p><p><a href=\"https://www.infoq.cn/article/t1OYQuveBtsjPBr6ETdx\">Terraform 1.3，简化重构体验</a>\"</p><p><a href=\"http://mp.weixin.qq.com/s?__biz=MzU1NDA4NjU2MA==&amp;mid=2247573031&amp;idx=3&amp;sn=212ca9f0a36efd481cc10382dd543ee8&amp;chksm=fbeb67e8cc9ceefe2fc5176fd82de194c2833ccac1d44588c486927a2379ab7dd8e17bf6ad2b&amp;scene=27#wechat_redirect\">为什么说 DevOps 治理是实现快速开发的关键</a>\"</p>",
    "publish_time": "2022-11-15 08:00:00",
    "source": {
      "name": "infoq_recommend",
      "desc": "InfoQ推荐",
      "icon": "https://raw.githubusercontent.com/maguowei/today/master/imgs/icon/infoq.png"
    }
  }
]